<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="styling.css">
    <script>
        MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
            fontCache: 'global'
        }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <title>Chapter 1 - 1.1</title> <!-- #################### TITLE #################### -->
</head>
\(
   \def\R{\mathbb{R}}
   \def\N{\mathbb{N}}
   \def\Z{\mathbb{Z}}
   \def\Q{\mathbb{Q}}
   \def\eps{\varepsilon}
   \def\epsilon{\varepsilon}
   \renewcommand{\geq}{\geqslant}
   \renewcommand{\leq}{\leqslant}
\)
<body>
    <div class="page">
<h1>Chapter 1 - Discrete Probability Distributions</h1>

<h2>1.1 Simulation of Discrete Probabilities</h2>
<br />
<table border="0">
    <tr>
        <td><b>Main</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Previous</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Next</b>:</td>
        <td><a href="ch01_01.02_DiscProbDist.html">1.2 Discrete Probability Distributions</a></td>
    </tr>
</table>
<br /><br />

<h3>Results and Examples</h3>

<br /><br /><br /><br />


<!-- ########################### EXERCISES ########################### -->

<h3>Exercise 1</h3>
Modify the program CoinTosses to toss a coin n times and print out after
every 100 tosses the proportion of heads minus 1/2. Do these numbers appear
to approach 0 as n increases? Modify the program again to print out, every
100 times, both of the following quantities: the proportion of heads minus 1/2,
and the number of heads minus half the number of tosses. Do these numbers
appear to approach 0 as n increases?

<br /><br />
<i>Answer</i><br />
Simulated 100.000 coin tosses. The first case has a very clear trend towards 0. The second case
converges to 0, just a bit more randomly.
<br /><br />

<b>Code</b>:
<!-- https://pinetools.com/syntax-highlighter -->
<!-- Style: Vs -->
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 1</span>
cointToss &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(nToss) {
    <span class="hljs-comment" style="color: green;"># 1 symbolizes coin toss 'H'</span>
    tosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size=nToss, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(tosses)
}

PropHeads &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(tosses) {
    propHeads = cumsum(tosses)
    numberOfHundreds = floor(length(tosses)/<span class="hljs-number">100</span>)
    retVal = rep(<span class="hljs-number">0</span>, numberOfHundreds)
    
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:numberOfHundreds) {
    print(propHeads[<span class="hljs-number">100</span>*k]/length(tosses) - <span class="hljs-number">0.5</span>)
    retVal[k] = propHeads[<span class="hljs-number">100</span>*k]/length(tosses) - <span class="hljs-number">0.5</span>
    } 
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(retVal)
} 
PropHeadsByTosses &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(tosses) {
    propHeads = cumsum(tosses)
    numberOfHundreds = floor(length(tosses)/<span class="hljs-number">100</span>)
    retVal = rep(<span class="hljs-number">0</span>, numberOfHundreds)
    
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:numberOfHundreds) {
    print(propHeads[<span class="hljs-number">100</span>*k]/(<span class="hljs-number">100</span>*k) - <span class="hljs-number">0.5</span>)
    retVal[k] = propHeads[<span class="hljs-number">100</span>*k]/(<span class="hljs-number">100</span>*k) - <span class="hljs-number">0.5</span>
    } 
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(retVal)
} 

<span class="hljs-comment" style="color: green;"># Simulating 100K tosses</span>
numbeOfTosses = <span class="hljs-number">100</span>*<span class="hljs-number">1000</span>
simulatedTosses = cointToss(numbeOfTosses)
t1 = PropHeads(simulatedTosses)
t2 = PropHeadsByTosses(simulatedTosses)

<span class="hljs-comment" style="color: green;"># Generate Plots</span>
plot(<span class="hljs-number">1</span>:length(t1), t1, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Total number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)

plot(<span class="hljs-number">1</span>:length(t2), t2, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)


<span class="hljs-comment" style="color: green;"># Save tosses</span>
png(filename=<span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/01.01_Ex01_01.png"</span>, width = <span class="hljs-number">600</span>, height = <span class="hljs-number">480</span>)
plot(<span class="hljs-number">1</span>:length(t1), t1, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Total number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)
dev.off()
png(filename=<span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/01.01_Ex01_02.png"</span>, width = <span class="hljs-number">600</span>, height = <span class="hljs-number">480</span>)
plot(<span class="hljs-number">1</span>:length(t2), t2, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)
dev.off()

</pre>
</div>
<br /><br />
<b>Plots</b>:<br />
<img src="img/01.01_Ex01_01.png" /><br />
<img src="img/01.01_Ex01_02.png" /><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 2</h3>
Modify the program CoinTosses so that it tosses a coin n times and records
whether or not the proportion of heads is within 0.1 of 0.5 (i.e., between 0.4
and .06). Have your program repeat this experiment 100 times. About how
large must n be so that approximately 95 out of 100 times the proportion of
heads is between 0.4 and 0.6?

<br /><br />
<i>Answer</i><br />
Based on repeated simulations, it seems like the proportion is consistently within 0.4 and 0.6
when $n = 100$, and maybe a little above, such as $n=110$ or $n=120$.
<br /><br />
<b>Code</b>:
<div clasS="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 2</span>
coinToss &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(nToss) {
    <span class="hljs-comment" style="color: green;"># 1 symbolizes coin toss 'H'</span>
    tosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size=nToss, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(tosses)
}

<span class="hljs-comment" style="color: green;"># Select n</span>
NSIM = <span class="hljs-number">120</span>
<span class="hljs-comment" style="color: green;"># Storing results</span>
propVector = rep(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)

<span class="hljs-comment" style="color: green;"># Repeat experiment 100 times:</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>) {
    tosses = coinToss(NSIM)
    propVector[k] = mean(tosses) 
} 

print(sum(propVector &gt; <span class="hljs-number">0.4</span> &amp; propVector &lt; <span class="hljs-number">0.6</span>)/length(propVector))</pre>
</div>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 3</h3>
In the early 1600s, Galileo was asked to explain the fact that, although the
number of triples of integers from 1 to 6 with sum 9 is the same as the number
of such triples with sum 10, when three dice are rolled, a 9 seemed to come
up less often than a 10—supposedly in the experience of gamblers.
<br /><br />
(a) Write a program to simulate the roll of three dice a large number of
times and keep track of the proportion of times that the sum is 9 and
the proportion of times it is 10.
<br /><br />
<i>Answer</i><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 3</span>
NSIM = <span class="hljs-number">1e6</span>

<span class="hljs-comment" style="color: green;"># Simulating three dice tosses</span>
d1 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
d2 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
d3 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)

<span class="hljs-comment" style="color: green;"># Sum of tosses</span>
sumDice = d1 + d2 + d3

<span class="hljs-comment" style="color: green;"># Number of 9s</span>
sum(sumDice == <span class="hljs-number">9</span>)/NSIM

<span class="hljs-comment" style="color: green;"># Number of 10s</span>
sum(sumDice == <span class="hljs-number">10</span>)/NSIM
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Number of 9s
> sum(sumDice == 9)/NSIM
[1] 0.115731
> # Number of 10s
> sum(sumDice == 10)/NSIM
[1] 0.124509
</pre>
Based on our simulations, it looks like 10 is in fact more frequent.
<br /><br /><br /><br />
(b) Can you conclude from your simulations that the gamblers were correct?
<br /><br />
<i>Answer</i><br />
The simulations can be repeated several times and the results are consistent, so we can make
an empirical conclusion. But we can't make a formal conclusion unless we prove it; there is
a very small chance that we are being fooled by the simulation. (And maybe it isn't even
implemented correctly).
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 4</h3>
In raquetball, a player continues to serve as long as she is winning; a point
is scored only when a player is serving and wins the volley. The first player
to win 21 points wins the game. Assume that you serve first and have a
probability 0.6 of winning a volley when you serve and probability 0.5 when
your opponent serves. Estimate, by simulation, the probability that you will
win a game.
<br /><br />
<i>Answer</i><br />
Simulating 100.000 games. The player appears to win in around 82.5% of the games.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 4 - Raquetball</span>

winPoint = <span class="hljs-number">0.4</span>
winBackServe = <span class="hljs-number">0.5</span>

NGAMES = <span class="hljs-number">100000</span>
<span class="hljs-comment" style="color: green;"># Initializing vector of results</span>
<span class="hljs-comment" style="color: green;"># 1: Player wins</span>
<span class="hljs-comment" style="color: green;"># 0: Opponent wins</span>
<span class="hljs-comment" style="color: green;"># -1: Default, empty value</span>
resultsVector = rep(-<span class="hljs-number">1</span>, NGAMES)

<span class="hljs-comment" style="color: green;"># Simulate game</span>
simulateGame &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(seededVals) {
    pPoints = <span class="hljs-number">0</span>
    oPoints = <span class="hljs-number">0</span>
    serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span>
    winner= -<span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:length(seededVals)) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> &amp; seededVals[k] &gt;= winPoint) {
            <span class="hljs-comment" style="color: green;"># Player wins point</span>
            pPoints = pPoints + <span class="hljs-number">1</span>
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> &amp; seededVals[k] &lt; winPoint) {
            <span class="hljs-comment" style="color: green;"># Player loses serve</span>
            serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> 
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> &amp; seededVals[k] &gt;= winBackServe) {
            <span class="hljs-comment" style="color: green;"># Opponent wins point</span>
            oPoints = oPoints + <span class="hljs-number">1</span>
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> &amp; seededVals[k] &lt; winBackServe) {
            <span class="hljs-comment" style="color: green;"># Opponent loses serve</span>
            serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> 
        }
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (pPoints == <span class="hljs-number">21</span> | oPoints == <span class="hljs-number">21</span>) {
            <span class="hljs-comment" style="color: green;"># Game finished - break for loop</span>
            <span class="hljs-comment" style="color: green;"># print("BREAK!")</span>
            <span class="hljs-comment" style="color: green;"># print(k)</span>
            <span class="hljs-keyword" style="color: rgb(0, 0, 255);">break</span>
        } 
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (pPoints == <span class="hljs-number">21</span>) winner = <span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (oPoints == <span class="hljs-number">21</span>) winner = <span class="hljs-number">0</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(winner)
} 

<span class="hljs-comment" style="color: green;"># More efficient to vectorize, but code is easier to understand this way</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    <span class="hljs-comment" style="color: green;"># Simulating 200 random uniform variables</span>
    simSeed = runif(<span class="hljs-number">200</span>)
    resultsVector[g] =  simulateGame(simSeed)
} 

WINRATE = sum(resultsVector)/length(resultsVector)
print(WINRATE)
</pre>
</div>
<br /><br />
<b>Output</b>
<pre class="rcode">
> print(WINRATE)
[1] 0.82536
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 5</h3>
Consider the bet that all three dice will turn up sixes at least once in n rolls
of three dice. Calculate $f(n)$, the probability of at least one triple-six when
three dice are rolled n times. Determine the smallest value of n necessary for
a favorable bet that a triple-six will occur when three dice are rolled n times.
(DeMoivre would say it should be about 216 log 2 = 149.7 and so would answer
150 — see Exercise 1.2.17. Do you agree with him?)
<br /><br />
<i>Answer</i><br />
According to the simulations performed, it seems that the proportion of simulations
where the first triple six occurs within the first 150 tosses is just above 50%.
In this case, I agree with DeMoivre.
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 5</span>

NREP = <span class="hljs-number">100000</span>
NSIM = <span class="hljs-number">200</span>

firstOccurrence = rep(<span class="hljs-number">0</span>, NREP)

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NREP) {
    <span class="hljs-comment" style="color: green;"># Simulating three dice tosses</span>
    d1 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    d2 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    d3 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    
    <span class="hljs-comment" style="color: green;"># Sum of tosses</span>
    sumDice = d1 + d2 + d3
    
    <span class="hljs-comment" style="color: green;"># Value which ensures victory in majority of cases</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (sum(sumDice == <span class="hljs-number">18</span>) &gt; <span class="hljs-number">0</span>) {
    firstTripleSix = min(which(sumDice == <span class="hljs-number">18</span>))
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
    firstTripleSix = NSIM
    } 
    firstOccurrence[i] = firstTripleSix
} 

print(sum(firstOccurrence &gt; <span class="hljs-number">150</span>)/NREP)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> print(sum(firstOccurrence > 150)/NREP)
[1] 0.50036
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 6</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 7</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 8</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 9</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 10</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 11</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 12</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 13</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 14</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 15</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 16</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 17</h3>
asd

<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />


<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
</div><!-- End page div-->
</body>
</html>

