<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="styling.css">
    <script>
        MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
            fontCache: 'global'
        }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <title>Chapter 1 - 1.1</title> <!-- #################### TITLE #################### -->
</head>
\(
   \def\R{\mathbb{R}}
   \def\N{\mathbb{N}}
   \def\Z{\mathbb{Z}}
   \def\Q{\mathbb{Q}}
   \def\eps{\varepsilon}
   \def\epsilon{\varepsilon}
   \renewcommand{\geq}{\geqslant}
   \renewcommand{\leq}{\leqslant}
\)
<body>
    <div class="page">
<h2>Chapter 1 - Discrete Probability Distributions</h2>

<h1>1.1 Simulation of Discrete Probabilities</h1>
<br />
<table border="0">
    <tr>
        <td><b>Main</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Previous</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Next</b>:</td>
        <td><a href="ch01_01.02_DiscProbDist.html">1.2 Discrete Probability Distributions</a></td>
    </tr>
</table>
<br /><br />

<!-- <h3>Results and Examples</h3>

<br /><br /><br /><br /> -->


<!-- ########################### EXERCISES ########################### -->

<h3>Exercise 1</h3>
Modify the program CoinTosses to toss a coin n times and print out after
every 100 tosses the proportion of heads minus 1/2. Do these numbers appear
to approach 0 as n increases? Modify the program again to print out, every
100 times, both of the following quantities: the proportion of heads minus 1/2,
and the number of heads minus half the number of tosses. Do these numbers
appear to approach 0 as n increases?

<br /><br />
<i>Answer</i><br />
Simulated 100.000 coin tosses. The first case has a very clear trend towards 0. The second case
converges to 0, just a bit more randomly.
<br /><br />

<b>Code</b>:
<!-- https://pinetools.com/syntax-highlighter -->
<!-- Style: Vs -->
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 1</span>
cointToss &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(nToss) {
    <span class="hljs-comment" style="color: green;"># 1 symbolizes coin toss 'H'</span>
    tosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size=nToss, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(tosses)
}

PropHeads &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(tosses) {
    propHeads = cumsum(tosses)
    numberOfHundreds = floor(length(tosses)/<span class="hljs-number">100</span>)
    retVal = rep(<span class="hljs-number">0</span>, numberOfHundreds)
    
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:numberOfHundreds) {
    print(propHeads[<span class="hljs-number">100</span>*k]/length(tosses) - <span class="hljs-number">0.5</span>)
    retVal[k] = propHeads[<span class="hljs-number">100</span>*k]/length(tosses) - <span class="hljs-number">0.5</span>
    } 
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(retVal)
} 
PropHeadsByTosses &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(tosses) {
    propHeads = cumsum(tosses)
    numberOfHundreds = floor(length(tosses)/<span class="hljs-number">100</span>)
    retVal = rep(<span class="hljs-number">0</span>, numberOfHundreds)
    
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:numberOfHundreds) {
    print(propHeads[<span class="hljs-number">100</span>*k]/(<span class="hljs-number">100</span>*k) - <span class="hljs-number">0.5</span>)
    retVal[k] = propHeads[<span class="hljs-number">100</span>*k]/(<span class="hljs-number">100</span>*k) - <span class="hljs-number">0.5</span>
    } 
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(retVal)
} 

<span class="hljs-comment" style="color: green;"># Simulating 100K tosses</span>
numbeOfTosses = <span class="hljs-number">100</span>*<span class="hljs-number">1000</span>
simulatedTosses = cointToss(numbeOfTosses)
t1 = PropHeads(simulatedTosses)
t2 = PropHeadsByTosses(simulatedTosses)

<span class="hljs-comment" style="color: green;"># Generate Plots</span>
plot(<span class="hljs-number">1</span>:length(t1), t1, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Total number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)

plot(<span class="hljs-number">1</span>:length(t2), t2, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)


<span class="hljs-comment" style="color: green;"># Save tosses</span>
png(filename=<span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/01.01_Ex01_01.png"</span>, width = <span class="hljs-number">600</span>, height = <span class="hljs-number">480</span>)
plot(<span class="hljs-number">1</span>:length(t1), t1, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Total number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)
dev.off()
png(filename=<span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/01.01_Ex01_02.png"</span>, width = <span class="hljs-number">600</span>, height = <span class="hljs-number">480</span>)
plot(<span class="hljs-number">1</span>:length(t2), t2, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>,
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Heads by Number of Tosses"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"100 tosses"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"H - 0.5"</span>)
dev.off()

</pre>
</div>
<br /><br />
<b>Plots</b>:<br />
<img src="img/01.01_Ex01_01.png" /><br />
<img src="img/01.01_Ex01_02.png" /><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 2</h3>
Modify the program CoinTosses so that it tosses a coin n times and records
whether or not the proportion of heads is within 0.1 of 0.5 (i.e., between 0.4
and .06). Have your program repeat this experiment 100 times. About how
large must n be so that approximately 95 out of 100 times the proportion of
heads is between 0.4 and 0.6?

<br /><br />
<i>Answer</i><br />
Based on repeated simulations, it seems like the proportion is consistently within 0.4 and 0.6
when $n = 100$, and maybe a little above, such as $n=110$ or $n=120$.
<br /><br />
<b>Code</b>:
<div clasS="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 2</span>
coinToss &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(nToss) {
    <span class="hljs-comment" style="color: green;"># 1 symbolizes coin toss 'H'</span>
    tosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size=nToss, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(tosses)
}

<span class="hljs-comment" style="color: green;"># Select n</span>
NSIM = <span class="hljs-number">120</span>
<span class="hljs-comment" style="color: green;"># Storing results</span>
propVector = rep(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)

<span class="hljs-comment" style="color: green;"># Repeat experiment 100 times:</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>) {
    tosses = coinToss(NSIM)
    propVector[k] = mean(tosses) 
} 

print(sum(propVector &gt; <span class="hljs-number">0.4</span> &amp; propVector &lt; <span class="hljs-number">0.6</span>)/length(propVector))</pre>
</div>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 3</h3>
In the early 1600s, Galileo was asked to explain the fact that, although the
number of triples of integers from 1 to 6 with sum 9 is the same as the number
of such triples with sum 10, when three dice are rolled, a 9 seemed to come
up less often than a 10â€”supposedly in the experience of gamblers.
<br /><br />
(a) Write a program to simulate the roll of three dice a large number of
times and keep track of the proportion of times that the sum is 9 and
the proportion of times it is 10.
<br /><br />
<i>Answer</i><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 3</span>
NSIM = <span class="hljs-number">1e6</span>

<span class="hljs-comment" style="color: green;"># Simulating three dice tosses</span>
d1 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
d2 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
d3 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)

<span class="hljs-comment" style="color: green;"># Sum of tosses</span>
sumDice = d1 + d2 + d3

<span class="hljs-comment" style="color: green;"># Number of 9s</span>
sum(sumDice == <span class="hljs-number">9</span>)/NSIM

<span class="hljs-comment" style="color: green;"># Number of 10s</span>
sum(sumDice == <span class="hljs-number">10</span>)/NSIM
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Number of 9s
> sum(sumDice == 9)/NSIM
[1] 0.115731
> # Number of 10s
> sum(sumDice == 10)/NSIM
[1] 0.124509
</pre>
Based on our simulations, it looks like 10 is in fact more frequent.
<br /><br /><br /><br />
(b) Can you conclude from your simulations that the gamblers were correct?
<br /><br />
<i>Answer</i><br />
The simulations can be repeated several times and the results are consistent, so we can make
an empirical conclusion. But we can't make a formal conclusion unless we prove it; there is
a very small chance that we are being fooled by the simulation. (And maybe it isn't even
implemented correctly).
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 4</h3>
In raquetball, a player continues to serve as long as she is winning; a point
is scored only when a player is serving and wins the volley. The first player
to win 21 points wins the game. Assume that you serve first and have a
probability 0.6 of winning a volley when you serve and probability 0.5 when
your opponent serves. Estimate, by simulation, the probability that you will
win a game.
<br /><br />
<i>Answer</i><br />
Simulating 100.000 games. The player appears to win in around 82.5% of the games.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 4 - Raquetball</span>

winPoint = <span class="hljs-number">0.4</span>
winBackServe = <span class="hljs-number">0.5</span>

NGAMES = <span class="hljs-number">100000</span>
<span class="hljs-comment" style="color: green;"># Initializing vector of results</span>
<span class="hljs-comment" style="color: green;"># 1: Player wins</span>
<span class="hljs-comment" style="color: green;"># 0: Opponent wins</span>
<span class="hljs-comment" style="color: green;"># -1: Default, empty value</span>
resultsVector = rep(-<span class="hljs-number">1</span>, NGAMES)

<span class="hljs-comment" style="color: green;"># Simulate game</span>
simulateGame &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(seededVals) {
    pPoints = <span class="hljs-number">0</span>
    oPoints = <span class="hljs-number">0</span>
    serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span>
    winner= -<span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:length(seededVals)) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> &amp; seededVals[k] &gt;= winPoint) {
            <span class="hljs-comment" style="color: green;"># Player wins point</span>
            pPoints = pPoints + <span class="hljs-number">1</span>
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> &amp; seededVals[k] &lt; winPoint) {
            <span class="hljs-comment" style="color: green;"># Player loses serve</span>
            serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> 
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> &amp; seededVals[k] &gt;= winBackServe) {
            <span class="hljs-comment" style="color: green;"># Opponent wins point</span>
            oPoints = oPoints + <span class="hljs-number">1</span>
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (serve == <span class="hljs-string" style="color: rgb(163, 21, 21);">"o"</span> &amp; seededVals[k] &lt; winBackServe) {
            <span class="hljs-comment" style="color: green;"># Opponent loses serve</span>
            serve = <span class="hljs-string" style="color: rgb(163, 21, 21);">"p"</span> 
        }
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (pPoints == <span class="hljs-number">21</span> | oPoints == <span class="hljs-number">21</span>) {
            <span class="hljs-comment" style="color: green;"># Game finished - break for loop</span>
            <span class="hljs-comment" style="color: green;"># print("BREAK!")</span>
            <span class="hljs-comment" style="color: green;"># print(k)</span>
            <span class="hljs-keyword" style="color: rgb(0, 0, 255);">break</span>
        } 
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (pPoints == <span class="hljs-number">21</span>) winner = <span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (oPoints == <span class="hljs-number">21</span>) winner = <span class="hljs-number">0</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(winner)
} 

<span class="hljs-comment" style="color: green;"># More efficient to vectorize, but code is easier to understand this way</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    <span class="hljs-comment" style="color: green;"># Simulating 200 random uniform variables</span>
    simSeed = runif(<span class="hljs-number">200</span>)
    resultsVector[g] =  simulateGame(simSeed)
} 

WINRATE = sum(resultsVector)/length(resultsVector)
print(WINRATE)
</pre>
</div>
<br /><br />
<b>Output</b>
<pre class="rcode">
> print(WINRATE)
[1] 0.82536
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 5</h3>
Consider the bet that all three dice will turn up sixes at least once in n rolls
of three dice. Calculate $f(n)$, the probability of at least one triple-six when
three dice are rolled n times. Determine the smallest value of n necessary for
a favorable bet that a triple-six will occur when three dice are rolled n times.
(DeMoivre would say it should be about 216 log 2 = 149.7 and so would answer
150 â€” see Exercise 1.2.17. Do you agree with him?)
<br /><br />
<i>Answer</i><br />
According to the simulations performed, it seems that the proportion of simulations
where the first triple six occurs within the first 150 tosses is just above 50%.
In this case, I agree with DeMoivre.
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 5</span>

NREP = <span class="hljs-number">100000</span>
NSIM = <span class="hljs-number">200</span>

firstOccurrence = rep(<span class="hljs-number">0</span>, NREP)

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NREP) {
    <span class="hljs-comment" style="color: green;"># Simulating three dice tosses</span>
    d1 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    d2 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    d3 = sample(c(<span class="hljs-number">1</span>:<span class="hljs-number">6</span>), size=NSIM, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    
    <span class="hljs-comment" style="color: green;"># Sum of tosses</span>
    sumDice = d1 + d2 + d3
    
    <span class="hljs-comment" style="color: green;"># Value which ensures victory in majority of cases</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (sum(sumDice == <span class="hljs-number">18</span>) &gt; <span class="hljs-number">0</span>) {
    firstTripleSix = min(which(sumDice == <span class="hljs-number">18</span>))
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
    firstTripleSix = NSIM
    } 
    firstOccurrence[i] = firstTripleSix
} 

print(sum(firstOccurrence &gt; <span class="hljs-number">150</span>)/NREP)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> print(sum(firstOccurrence > 150)/NREP)
[1] 0.50036
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 6</h3>
In Las Vegas, a roulette wheel has 38 slots numbered 0, 00, 1, 2, ..., 36. The
0 and 00 slots are green and half of the remaining 36 slots are red and half
are black. A croupier spins the wheel and throws in an ivory ball. If you bet
1 dollar on red, you win 1 dollar if the ball stops in a red slot and otherwise
you lose 1 dollar. Write a program to find the total winnings for a player who
makes 1000 bets on red.
<br /><br />
<i>Answer</i><br />
A player who only plays on red will lose money - around -52 on average based on repeated simulations.
<br /><br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 6 - Roulette</span>

<span class="hljs-comment" style="color: green;"># Simulate 1000 different situations, where a player bets</span>
<span class="hljs-comment" style="color: green;"># on red 1000 times.</span>
NSIM = <span class="hljs-number">10000</span>
NGAMES = <span class="hljs-number">1000</span>

TOTWINS = rep(<span class="hljs-number">0</span>, NSIM)

<span class="hljs-comment" style="color: green;"># 37 is "0"</span>
<span class="hljs-comment" style="color: green;"># 38 is "00"</span>
<span class="hljs-comment" style="color: green;"># 1-18 is RED</span>
<span class="hljs-comment" style="color: green;"># 19-36 is BLACK</span>

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NSIM) {
    winnings = <span class="hljs-number">0</span>
    <span class="hljs-comment" style="color: green;"># Roulette</span>
    roulette = sample(<span class="hljs-number">1</span>:<span class="hljs-number">38</span>, size = NGAMES, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (roulette[g] &lt;= <span class="hljs-number">18</span>) {
            <span class="hljs-comment" style="color: green;"># Win!</span>
            winnings = winnings + <span class="hljs-number">1</span>
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
            <span class="hljs-comment" style="color: green;"># Loss - black or green</span>
            winnings = winnings - <span class="hljs-number">1</span>
        }
    }
    TOTWINS[k] = winnings 
}

print(mean(TOTWINS))
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> print(mean(TOTWINS))
[1] -52.304
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 7</h3>
Another form of bet for roulette is to bet that a specific number (say 17) will
turn up. If the ball stops on your number, you get your dollar back plus 35
dollars. If not, you lose your dollar. Write a program that will plot your
winnings when you make 500 plays of roulette at Las Vegas, first when you
bet each time on red (see Exercise 6), and then for a second visit to Las
Vegas when you make 500 plays betting each time on the number 17. What
differences do you see in the graphs of your winnings on these two occasions?
<br /><br />
<i>Answer</i><br />
There is a lot more variation in the blue line, which is the riskier bet. Since it is a lot more risk,
there is the potential for a huge payout as well. Sometimes it results in great rewards.
<br /><br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 7 - Roulette II</span>

<span class="hljs-comment" style="color: green;"># Simulate 1000 different situations, where a player bets</span>
<span class="hljs-comment" style="color: green;"># on red 1000 times.</span>
NGAMES = <span class="hljs-number">500</span>

<span class="hljs-comment" style="color: green;"># 37 is "0"</span>
<span class="hljs-comment" style="color: green;"># 38 is "00"</span>
<span class="hljs-comment" style="color: green;"># 1-18 is RED</span>
<span class="hljs-comment" style="color: green;"># 19-36 is BLACK</span>

winnings = rep(<span class="hljs-number">0</span>, NGAMES)
winnings17 = rep(<span class="hljs-number">0</span>, NGAMES)
<span class="hljs-comment" style="color: green;"># Roulette</span>
roulette = sample(<span class="hljs-number">1</span>:<span class="hljs-number">38</span>, size = NGAMES, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (roulette[g] &lt;= <span class="hljs-number">18</span>) {
        <span class="hljs-comment" style="color: green;"># Win!</span>
        winnings[g] = <span class="hljs-number">1</span>
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
     <span class="hljs-comment" style="color: green;"># Loss - black or green</span>
        winnings[g] = - <span class="hljs-number">1</span>
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (roulette[g] == <span class="hljs-number">17</span>) {
        winnings17[g] = <span class="hljs-number">36</span>
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        winnings17[g] = -<span class="hljs-number">1</span>
    } 
}

winnings = cumsum(winnings)
winnings17 = cumsum(winnings17)

print(winnings)
print(winnings17)

yMIN = min(winnings, winnings17)
yMAX = max(winnings, winnings17)

plot(<span class="hljs-number">1</span>:<span class="hljs-number">500</span>, winnings, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, ylim=c(yMIN, yMAX),
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Roulette: Strategy RED vs. 17"</span>,
        xlab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"500 games"</span>, ylab=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Winnings"</span>)
lines(<span class="hljs-number">1</span>:<span class="hljs-number">500</span>, winnings17, type=<span class="hljs-string" style="color: rgb(163, 21, 21);">"l"</span>, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"blue"</span>)</pre>
</div>
<br />
<b>Output</b><br />
Note that even though it sometimes gives a huge reward, the '17' strategy will also give huge losses most of the time.
Note that the 'RED' strategy goes to around -50 after 500 games, as found in the previous exercise.
<br /><br />
<img src="img/01.01_Ex07.png" />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 8</h3>
An astute student noticed that, in our simulation of the game of heads or tails
(see Example 1.4), the proportion of times the player is always in the lead is
very close to the proportion of times that the player's total winnings end up 0.
Work out these probabilities by enumeration of all cases for two tosses and
for four tosses, and see if you think that these probabilities are, in fact, the
same.
<br /><br />
<i>Answer</i><br />
First, the case of two tosses. All possible outcomes are:
<br /><br />
<table class="pTab">
    <tr>
        <th>Outcome</th>
        <th>Always lead</th>
        <th>No payout</th>
    </tr>
    <tr>
        <td>HH</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>HT</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>TH</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>TT</td>
        <td>T</td>
        <td></td>
    </tr>
</table>
In this case two outcomes have someone always in the lead, and two outcomes result in no payout.
So in this case, they are proportional.
<br /><br />
Next, the case of four tosses. All possible outcomes are:
<br /><br />
<table class="pTab">
    <tr>
        <th>Outcome</th>
        <th>Always lead</th>
        <th>No payout</th>
    </tr>
    <tr>
        <td>HHHH</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>HHHT</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>HHTH</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>HTHH</td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>THHH</td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>HHTT</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>HTHT</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>THHT</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>HTTH</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>THTH</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>TTHH</td>
        <td></td>
        <td>T</td>
    </tr>
    <tr>
        <td>HTTT</td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>THTT</td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>TTHT</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>TTTH</td>
        <td>T</td>
        <td></td>
    </tr>
    <tr>
        <td>TTTT</td>
        <td>T</td>
        <td></td>
    </tr>
</table>
<br /><br />
If we never allow the lead to go back to 0, then 'always in the lead' and 'no payout' each
consist of 6 of the possible 16 outcomes. This will likely generalize to n coin tosses. 
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 9</h3>
The <i>Labouchere</i> system for roulette is played as follows. Write down a list of
numbers, usually 1, 2, 3, 4. Bet the sum of the first and last, 1 + 4 = 5, on
red. If you win, delete the first and last numbers from your list. If you lose,
add the amount that you last bet to the end of your list. Then use the new
list and bet the sum of the first and last numbers (if there is only one number,
bet that amount). Continue until your list becomes empty. Show that, if this
happens, you win the sum, 1 + 2 + 3 + 4 = 10, of your original list. Simulate
this system and see if you do always stop and, hence, always win. If so, why
is this not a foolproof gambling system?
<br /><br />
<i>Answer</i><br />
After many repeated simulations, the algorithm always terminates and the final winnings is 10.
This is not a foolproof system, because there might be sections with high bets and periods where
the player is heavily in the minus. In other words, there is a chance the player will become
bankrupt.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 9 - Roulette III (Labouchere)</span>

numberList = c(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>)

<span class="hljs-comment" style="color: green;"># Labouchere bet</span>
getLabNumber &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(pl) {
    retval = <span class="hljs-number">0</span>
    <span class="hljs-comment" style="color: green;"># If only one value, return it</span>
    <span class="hljs-comment" style="color: green;"># Else add the first and last of the ProvidedList</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (length(pl) == <span class="hljs-number">1</span>) {
        retval = pl[<span class="hljs-number">1</span>] 
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        retval = pl[<span class="hljs-number">1</span>] + pl[length(pl)]
    } 
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(retval)
}

<span class="hljs-comment" style="color: green;"># Roulette</span>
winnings = <span class="hljs-number">0</span>
minWinnings = <span class="hljs-number">0</span>
playing = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">while</span>(playing) {
    roulette = sample(<span class="hljs-number">1</span>:<span class="hljs-number">38</span>, size = <span class="hljs-number">1</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    betValue = getLabNumber(numberList)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (roulette &lt;= <span class="hljs-number">18</span>) {
    <span class="hljs-comment" style="color: green;"># Win!</span>
    winnings = winnings + betValue
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(length(numberList) &gt; <span class="hljs-number">2</span>) {
        numberList = numberList[<span class="hljs-number">2</span>:(length(numberList)-<span class="hljs-number">1</span>)] 
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(length(numberList) == <span class="hljs-number">2</span>) {
        numberList = c() 
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        numberList = c()
    } 
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        <span class="hljs-comment" style="color: green;"># Loss - black or green</span>
        winnings = winnings - betValue
        numberList = c(numberList, betValue)
    }
    games = games + <span class="hljs-number">1</span>
    <span class="hljs-comment" style="color: green;"># Ending game</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (length(numberList) == <span class="hljs-number">0</span>) playing = <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>
    
    <span class="hljs-comment" style="color: green;"># Logging minimal value</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(winnings &lt; minWinnings) minWinnings &lt;- winnings
    
    <span class="hljs-comment" style="color: green;"># Printing some results</span>
    print(<span class="hljs-string" style="color: rgb(163, 21, 21);">"-----------------------"</span>)
    cat(paste0(<span class="hljs-string" style="color: rgb(163, 21, 21);">"Betting value          : "</span>, betValue, <span class="hljs-string" style="color: rgb(163, 21, 21);">"\n"</span>))
    cat(paste0(<span class="hljs-string" style="color: rgb(163, 21, 21);">"Outcome (&lt;= 18 is win) : "</span>, roulette, <span class="hljs-string" style="color: rgb(163, 21, 21);">"\n"</span>))
    cat(<span class="hljs-string" style="color: rgb(163, 21, 21);">"Remainging list        : "</span>)
    print(cat(numberList))
} 
winnings
minWinnings
</pre>
</div>
<br />
<br />
<b>Output</b>
<pre class="rcode">
> winnings
[1] 10
> minWinnings
[1] -442
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 10</h3>
Another well-known gambling system is the <i>martingale doubling system</i>.
Suppose that you are betting on red to turn up in roulette. Every time you win,
bet 1 dollar next time. Every time you lose, double your previous bet. Suppose
that you use this system until you have won at least 5 dollars or you have lost
more than 100 dollars. Write a program to simulate this and play it a number
of times and see how you do. In his book <i>The Newcomes</i>, W. M. Thackeray remarks
"You have not played as yet? Do not do so; above all avoid a
martingale if you do." Was this good advice?
<br /><br />
<i>Answer</i><br />
Winning 5 is quite consistent, but too often the total loss triggers the stop loss strategy.
After 1000 simulations (see below) the mean winnings is consistently negative, (though not very negative).
This could be considered a game breaking strategy if we assume infinite wealth and that we can continue
playing indefinitely.
<br /><br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 10 - Martingale Doubling System</span>

<span class="hljs-comment" style="color: green;"># Roulette</span>
NGAMES = <span class="hljs-number">1000</span>
ALLGAMES = rep(<span class="hljs-number">0</span>, NGAMES)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    winnings = <span class="hljs-number">0</span>
    minWinnings = <span class="hljs-number">0</span>
    playing = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>
    betValue = <span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">while</span>(playing) {
    roulette = sample(<span class="hljs-number">1</span>:<span class="hljs-number">38</span>, size = <span class="hljs-number">1</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (roulette &lt;= <span class="hljs-number">18</span>) {
        <span class="hljs-comment" style="color: green;"># Win!</span>
        winnings = winnings + betValue
        betValue = <span class="hljs-number">1</span>
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        <span class="hljs-comment" style="color: green;"># Loss - black or green</span>
        winnings = winnings - betValue
        betValue = <span class="hljs-number">2</span>*betValue
    }
    <span class="hljs-comment" style="color: green;"># Ending game</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (winnings &gt;= <span class="hljs-number">5</span>) playing = <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (winnings &lt;= -<span class="hljs-number">100</span>) playing = <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>
    
    <span class="hljs-comment" style="color: green;"># Logging minimal value</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(winnings &lt; minWinnings) minWinnings &lt;- winnings
    } 
    ALLGAMES[g] = winnings
} 
mean(ALLGAMES)
</pre>
</div>
<br />
<br />
<b>Outcome - 1000 games</b>
<pre class="rcode">
    > ALLGAMES
    [1]    5    5    5    5    5    5    5 -126    5    5    5    5    5    5    5 -127    5    5    5    5    5    5
   [23]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
   [45]    5    5    5    5    5    5    5    5    5    5    5 -126 -123    5 -124    5    5    5    5    5    5    5
   [67]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -123    5    5    5    5    5    5
   [89]    5 -123    5    5    5    5    5    5    5    5    5    5    5    5    5 -124    5    5    5 -126    5    5
  [111]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [133]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -123    5    5    5    5    5
  [155]    5    5    5    5    5    5    5    5 -125    5    5    5    5    5    5 -124    5 -125    5    5    5    5
  [177]    5 -123    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [199]    5    5    5    5    5    5    5    5    5    5    5    5 -127    5 -123    5    5    5    5    5    5    5
  [221]    5    5 -123    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [243]    5    5    5    5    5    5 -123    5    5    5    5    5    5    5    5    5    5 -124    5    5    5    5
  [265]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -125    5    5    5    5
  [287]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -123    5    5
  [309]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [331]    5    5    5    5    5    5    5    5 -126    5    5    5    5    5    5    5    5    5    5    5    5    5
  [353]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [375]    5    5    5    5    5    5    5    5    5    5 -123    5 -123    5    5    5    5    5    5    5    5    5
  [397] -123 -123    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [419]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [441]    5    5    5 -124    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [463]    5    5    5    5    5    5    5 -127    5    5    5    5    5    5 -125    5    5    5    5    5    5    5
  [485]    5 -123    5    5    5    5    5    5    5    5 -124    5    5    5    5    5    5    5    5    5    5    5
  [507]    5    5    5    5    5    5    5 -124    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [529]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [551]    5    5    5    5    5    5    5    5    5    5 -127    5    5    5    5 -126    5    5    5    5    5    5
  [573]    5    5    5    5    5    5    5    5    5    5    5 -123    5 -126    5    5    5    5 -123    5    5    5
  [595]    5    5    5 -127    5    5    5 -127    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [617]    5    5    5    5    5    5    5    5    5    5    5    5    5 -125    5 -124    5    5 -126    5    5    5
  [639]    5 -124 -123    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [661]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [683]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [705]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [727]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [749]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [771]    5    5 -125    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -124    5    5    5
  [793]    5    5    5 -123    5 -124    5    5    5    5    5    5 -127    5    5    5    5    5    5    5    5    5
  [815]    5 -124    5    5    5    5    5    5 -127    5    5    5    5    5    5    5    5    5    5    5    5    5
  [837]    5 -125    5    5    5    5    5    5    5 -123    5    5    5    5    5    5    5    5    5    5    5    5
  [859]    5    5    5    5    5    5    5    5    5    5    5    5 -127    5    5    5    5    5    5    5    5    5
  [881]    5    5    5    5    5 -127    5    5    5    5    5 -123    5    5    5    5    5    5    5    5    5    5
  [903]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [925]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5
  [947]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -123    5    5    5
  [969]    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5    5 -125    5
  [991] -123    5    5    5    5    5    5    5    5    5

  > mean(ALLGAMES)
[1] -2.641
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 11</h3>
Modify the program <b>HTSimulation</b> so that it keeps track of the maximum of
Peterâ€™s winnings in each game of 40 tosses. Have your program print out the
proportion of times that your total winnings take on values 0, 2, 4, ..., 40.
Calculate the corresponding exact probabilities for games of two tosses and
four tosses.
<br /><br />
<i>Answer</i><br />
Roughly 12% of the games end with a 2 penny profit for Peter, then roughly 10% for a 4 penny profit,
and from there it quickly falls to 0.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 11 - Heads or Tails</span>
NUMCOINTOSS = <span class="hljs-number">40</span>

RunGame &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>() {
    coinTosses = sample(c(<span class="hljs-string" style="color: rgb(163, 21, 21);">"H"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"T"</span>), size = NUMCOINTOSS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(coinTosses)
}

CalculateScore &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(gameRes){
    <span class="hljs-comment" style="color: green;"># H: Peter gets a penny</span>
    <span class="hljs-comment" style="color: green;"># T: Paul gets a penny</span>
    stateWinnings = rep(<span class="hljs-number">0</span>, length(gameRes))
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:length(gameRes)) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (gameRes[k] == <span class="hljs-string" style="color: rgb(163, 21, 21);">"H"</span>) {
        stateWinnings[k] = <span class="hljs-number">1</span>
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        stateWinnings[k] = -<span class="hljs-number">1</span>
    } 
    }
    totWins = sum(stateWinnings)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(totWins)
}

NGAMES = <span class="hljs-number">10000</span>
propGames = rep(<span class="hljs-number">0</span>, NGAMES)
gameProp = rep(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    coinRes = RunGame()
    oneGame = CalculateScore(coinRes)
    propGames[g]= oneGame
}
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (v <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> seq(<span class="hljs-number">2</span>, <span class="hljs-number">40</span>, <span class="hljs-number">2</span>)) {
    print(<span class="hljs-string" style="color: rgb(163, 21, 21);">"------------"</span>)
    print(paste0(<span class="hljs-string" style="color: rgb(163, 21, 21);">"Total win: "</span>, v))
    print(sum(propGames == v)/length(propGames))
}
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
[1] "------------"
[1] "Total win: 2"
[1] 0.1222
[1] "------------"
[1] "Total win: 4"
[1] 0.1013
[1] "------------"
[1] "Total win: 6"
[1] 0.0816
[1] "------------"
[1] "Total win: 8"
[1] 0.0564
[1] "------------"
[1] "Total win: 10"
[1] 0.0368
[1] "------------"
[1] "Total win: 12"
[1] 0.0186
[1] "------------"
[1] "Total win: 14"
[1] 0.0116
[1] "------------"
[1] "Total win: 16"
[1] 0.0042
[1] "------------"
[1] "Total win: 18"
[1] 0.0026
[1] "------------"
[1] "Total win: 20"
[1] 5e-04
[1] "------------"
[1] "Total win: 22"
[1] 2e-04
[1] "------------"
[1] "Total win: 24"
[1] 0
[1] "------------"
[1] "Total win: 26"
[1] 1e-04
[1] "------------"
[1] "Total win: 28"
[1] 0
[1] "------------"
[1] "Total win: 30"
[1] 0
[1] "------------"
[1] "Total win: 32"
[1] 0
[1] "------------"
[1] "Total win: 34"
[1] 0
[1] "------------"
[1] "Total win: 36"
[1] 0
[1] "------------"
[1] "Total win: 38"
[1] 0
[1] "------------"
[1] "Total win: 40"
[1] 0
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 12</h3>
In an upcoming national election for the President of the United States, a
pollster plans to predict the winner of the popular vote by taking a random
sample of 1000 voters and declaring that the winner will be the one obtaining
the most votes in his sample. Suppose that 48 percent of the voters plan
to vote for the Republican candidate and 52 percent plan to vote for the
Democratic candidate. To get some idea of how reasonable the pollsterâ€™s
plan is, write a program to make this prediction by simulation. Repeat the
simulation 100 times and see how many times the pollsterâ€™s prediction would
come true. Repeat your experiment, assuming now that 49 percent of the
population plan to vote for the Republican candidate; first with a sample of
1000 and then with a sample of 3000. (The Gallup Poll uses about 3000.)
(This idea is discussed further in Chapter 9, Section 9.1.)
<br /><br />
<i>Answer</i><br />
The first example works quite well, the second is not accurate enough. But with 3000 respondents,
the result in the third case appears to be okay. But it requires the sampling to be completely
random!
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 12 - Election Pollsters</span>

simulateThousandVoters &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(probD, probR, numberAsked) {
    res = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size=numberAsked, replace=<span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>, prob=c(probR, probD))
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(mean(res))
} 

<span class="hljs-comment" style="color: green;"># Experiment 1 - 0.48 vs 0.52 with 1000</span>
exp1 = rep(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>) {
    exp1[k] = simulateThousandVoters(<span class="hljs-number">0.52</span>, <span class="hljs-number">0.48</span>, <span class="hljs-number">1000</span>)
}
<span class="hljs-comment" style="color: green;"># Experiment 2 - 0.49 vs 0.51 with 1000</span>
exp2 = rep(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>) {
    exp2[k] = simulateThousandVoters(<span class="hljs-number">0.51</span>, <span class="hljs-number">0.49</span>, <span class="hljs-number">1000</span>)
}
<span class="hljs-comment" style="color: green;"># Experiment 1 - 0.49 vs 0.51 with 3000</span>
exp3 = rep(<span class="hljs-number">0</span>, <span class="hljs-number">100</span>)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">100</span>) {
    exp3[k] = simulateThousandVoters(<span class="hljs-number">0.51</span>, <span class="hljs-number">0.49</span>, <span class="hljs-number">3000</span>)
}

<span class="hljs-comment" style="color: green;"># Correct Values</span>
sum(exp1 &gt; <span class="hljs-number">0.5</span>)/length(exp1)
sum(exp2 &gt; <span class="hljs-number">0.5</span>)/length(exp2)
sum(exp3 &gt; <span class="hljs-number">0.5</span>)/length(exp3)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Correct Values
> sum(exp1 > 0.5)/length(exp1)
[1] 0.89
> sum(exp2 > 0.5)/length(exp2)
[1] 0.74
> sum(exp3 > 0.5)/length(exp3)
[1] 0.86
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />


<h3>Exercise 13</h3>
The psychologist Tversky and his colleagues say that about four out of five
people will answer (a) to the following question:
<br /><br />
A certain town is served by two hospitals. In the larger hospital about 45
babies are born each day, and in the smaller hospital 15 babies are born each
day. Although the overall proportion of boys is about 50 percent, the actual
proportion at either hospital may be more or less than 50 percent on any day.
At the end of a year, which hospital will have the greater number of days on
which more than 60 percent of the babies born were boys?
<br /><br />
(a) the large hospital<br />
(b) the small hospital<br />
(c) neither â€” the number of days will be about the same.
<br /><br />
Assume that the probability that a baby is a boy is 0.5 (actual estimates make
this more like 0.513). Decide, by simulation, what the right answer is to the
question. Can you suggest why so many people go wrong?
<br /><br />
<i>Answer</i><br />
The correct answer is (b). Since the sample size is smaller, it is more uncertain. If a hospital had
one million births per day, it would likely never have a single day where 60% of the births were boys.
<br /><br />
Difficult to say why people get the answer wrong by suggesting the larger hospital. Maybe it is as simple as
confusing the larger number of births with a large percentage?
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 13 - Babies and Hospitals</span>
hospLargeOver60 = <span class="hljs-number">0</span>
hospSmallOver60 = <span class="hljs-number">0</span>

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (d <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:<span class="hljs-number">365</span>) {
    <span class="hljs-comment" style="color: green;"># Large hospital births - 1 is boy</span>
    hl = sample(c(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), size = <span class="hljs-number">45</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (mean(hl) &gt;= <span class="hljs-number">0.6</span>) {
    hospLargeOver60 = hospLargeOver60 + <span class="hljs-number">1</span>
    } 
    <span class="hljs-comment" style="color: green;"># Small hospital births - 1 is boy</span>
    hs = sample(c(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>), size = <span class="hljs-number">15</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (mean(hs) &gt;= <span class="hljs-number">0.6</span>) {
    hospSmallOver60 = hospSmallOver60 + <span class="hljs-number">1</span>
    } 
} 
<span class="hljs-comment" style="color: green;"># Print results</span>
hospLargeOver60
hospSmallOver60</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> hospLargeOver60
[1] 35
> hospSmallOver60
[1] 104
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 14</h3>
You are offered the following game. A fair coin will be tossed until the first
time it comes up heads. If this occurs on the jth toss you are paid 2 j dollars.
You are sure to win at least 2 dollars so you should be willing to pay to play
this gameâ€”but how much? Few people would pay as much as 10 dollars to
play this game. See if you can decide, by simulation, a reasonable amount
that you would be willing to pay, per game, if you will be allowed to make
a large number of plays of the game. Does the amount that you would be
willing to pay per game depend upon the number of plays that you will be
allowed?
<br /><br />
<i>Answer</i><br />
According to the simulation results, 4 dollars should be an acceptable amount to pay.
As long as the number of allowed games is at least 20, it should be fine since the probability of
not getting a H within 20 tosses is extremely low.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 14 - Coin Toss Game</span>

NGAMES = <span class="hljs-number">10000</span>
payout = rep(<span class="hljs-number">0</span>, NGAMES)

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span>(g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    <span class="hljs-comment" style="color: green;"># Heads is 1</span>
    coinTosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size = <span class="hljs-number">100</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-comment" style="color: green;"># First heads</span>
    j = min(which(coinTosses == <span class="hljs-number">1</span>))
    payout[g] = <span class="hljs-number">2</span>*j 
}
mean(payout)
max(payout)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> mean(payout)
[1] 4.0076
> max(payout)
[1] 32
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 15</h3>
Tversky and his colleagues studied the records of 48 of the Philadelphia
76ers basketball games in the 1980â€“81 season to see if a player had times
when he was hot and every shot went in, and other times when he was cold
and barely able to hit the backboard. The players estimated that they were
about 25 percent more likely to make a shot after a hit than after a miss.
In fact, the opposite was true â€” the 76ers were 6 percent more likely to score
after a miss than after a hit. Tversky reports that the number of hot and cold
streaks was about what one would expect by purely random effects. Assuming
that a player has a fifty-fifty chance of making a shot and makes 20 shots a
game, estimate by simulation the proportion of the games in which the player
will have a streak of 5 or more hits.
<br /><br />
<i>Answer</i><br />
According to the simulations a player will have a streak of 5 or more hits in around 25% of the games.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 15 - Basketball</span>

calcStreak &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(tosses) {
    mxVal = <span class="hljs-number">0</span>
    crnStreak = <span class="hljs-number">0</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span>(i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:length(tosses)) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (tosses[i] == <span class="hljs-number">1</span>) {
            crnStreak = crnStreak + <span class="hljs-number">1</span>
            <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (crnStreak &gt; mxVal) mxVal = crnStreak
        } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
            crnStreak = <span class="hljs-number">0</span>
        } 
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(mxVal)
}

simGame &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>() {
    <span class="hljs-comment" style="color: green;"># 1 is a score</span>
    tosses = sample(c(<span class="hljs-number">0</span>,<span class="hljs-number">1</span>), size = <span class="hljs-number">20</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(calcStreak(tosses))
}

<span class="hljs-comment" style="color: green;"># Simulating games</span>
NGAMES = <span class="hljs-number">10000</span>
hotGames = rep(<span class="hljs-number">0</span>, NGAMES)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (g <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NGAMES) {
    hotGames[g] = simGame()
}
sum(hotGames &gt;= <span class="hljs-number">5</span>)/length(hotGames)</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> sum(hotGames >= 5)/length(hotGames)
[1] 0.2582
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 16</h3>
Estimate, by simulation, the average number of children there would be in
a family if all people had children until they had a boy. Do the same if all
people had children until they had at least one boy and at least one girl. How
many more children would you expect to find under the second scheme than
under the first in 100,000 families? (Assume that boys and girls are equally
likely.)
<br /><br />
<i>Answer</i><br />
If the families want a boy, the 100.000 families will collectively have about 200.000 children.
If the families want both, they will have around 300.000 children, about 50% as many.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 16 - Boys and Girls</span>

findBoy &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(childList) {
    numChildren = min(which(childList == <span class="hljs-string" style="color: rgb(163, 21, 21);">"B"</span>))
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(numChildren)
} 
findBoyAndGirl &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(childList) {
    numChildren1 = min(which(childList == <span class="hljs-string" style="color: rgb(163, 21, 21);">"B"</span>))
    numChildren2 = min(which(childList == <span class="hljs-string" style="color: rgb(163, 21, 21);">"G"</span>))
    numChildren = max(numChildren1, numChildren2)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(numChildren)
} 

FAMS = <span class="hljs-number">100000</span>
numChildrenBoys = rep(<span class="hljs-number">0</span>, FAMS)
numChildrenBoth = rep(<span class="hljs-number">0</span>, FAMS)

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (f <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:FAMS) {
    children = sample(c(<span class="hljs-string" style="color: rgb(163, 21, 21);">"B"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"G"</span>), size=<span class="hljs-number">20</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    numChildrenBoys[f] = findBoy(children)
    numChildrenBoth[f] = findBoyAndGirl(children)
}
sum(numChildrenBoys)
sum(numChildrenBoth)
sum(numChildrenBoth)/sum(numChildrenBoys)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> sum(numChildrenBoys)
[1] 199637
> sum(numChildrenBoth)
[1] 300321
> sum(numChildrenBoth)/sum(numChildrenBoys)
[1] 1.504335
</pre>
<div class="exend">&#9632;</div>
<br /><br />

<h3>Exercise 17</h3>
Mathematicians have been known to get some of the best ideas while sitting in
a cafe, riding on a bus, or strolling in the park. In the early 1900s the famous
mathematician George PÃ³lya lived in a hotel near the woods in Zurich. He
liked to walk in the woods and think about mathematics. PÃ³lya describes the
following incident:
<br /><br />
<div class="indent">
At the hotel there lived also some students with whom I usually
took my meals and had friendly relations. On a certain day one
of them expected the visit of his fiancÃ©e, what (sic) I knew, but
I did not foresee that he and his fiancÃ©e would also set out for a
stroll in the woods, and then suddenly I met them there. And then
I met them the same morning repeatedly, I donâ€™t remember how
many times, but certainly much too often and I felt embarrassed:
It looked as if I was snooping around which was, I assure you, not
the case.
</div>
<br />
This set him to thinking about whether random walkers were destined to
meet.
<br /><br />
PÃ³lya considered random walkers in one, two, and three dimensions. In one
dimension, he envisioned the walker on a very long street. At each intersection
the walker flips a fair coin to decide which direction to walk next (see
Figure 1.6a). In two dimensions, the walker is walking on a grid of streets, and
at each intersection he chooses one of the four possible directions with equal
probability (see Figure 1.6b). In three dimensions (we might better speak of
a random climber), the walker moves on a three-dimensional grid, and at each
intersection there are now six different directions that the walker may choose,
each with equal probability (see Figure 1.6c).
<br /><br />
The reader is referred to Section 12.1, where this and related problems are
discussed.
<br /><br />
<b>(a)</b> Write a program to simulate a random walk in one dimension starting
at 0. Have your program print out the lengths of the times between
returns to the starting point (returns to 0). See if you can guess from
this simulation the answer to the following question: Will the walker
always return to his starting point eventually or might he drift away
forever?
<br /><br />
<b>(b)</b> The paths of two walkers in two dimensions who meet after n steps can
be considered to be a single path that starts at (0, 0) and returns to (0, 0)
after 2n steps. This means that the probability that two random walkers
in two dimensions meet is the same as the probability that a single walker
in two dimensions ever returns to the starting point. Thus the question
of whether two walkers are sure to meet is the same as the question of
whether a single walker is sure to return to the starting point.
Write a program to simulate a random walk in two dimensions and see
if you think that the walker is sure to return to (0, 0). If so, PÃ³lya would
be sure to keep meeting his friends in the park. Perhaps by now you
have conjectured the answer to the question: Is a random walker in one
or two dimensions sure to return to the starting point? PÃ³lya answered
this question for dimensions one, two, and three. He established the
remarkable result that the answer is yes in one and two dimensions and
<i>no</i> in three dimensions.
<br /><br />
<b>(c)</b> Write a program to simulate a random walk in three dimensions and see
whether, from this simulation and the results of (a) and (b), you could
have guessed PÃ³lyaâ€™s result.
<br /><br />
<img src="img/IntroProb_01_RandomWalk.png" />
<br /><br />
<i>Answer</i><br />
<b>(a)</b><br >
From our simulations the random walker usually returns to the starting point quite quickly, but
sometimes it takes a while. The average of 1000 simulations was about 66.038. In 6 of the cases
the walker did not return after 10.000 steps, so sometimes the walker never returns.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 17a - Random Walk</span>

RandomWalk1D &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>() {
    walkDirection = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = <span class="hljs-number">10000</span>, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    back = cumsum(walkDirection)
    <span class="hljs-comment" style="color: green;"># print(min(which(back == 0)))</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (sum(back == <span class="hljs-number">0</span>) == <span class="hljs-number">0</span>) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(-<span class="hljs-number">1</span>)
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(min(which(back == <span class="hljs-number">0</span>)))
    } 
}

NWALKS = <span class="hljs-number">1000</span>
walkRes = rep(<span class="hljs-number">0</span>, NWALKS)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NWALKS) {
    walkRes[i]= RandomWalk1D()
}
<span class="hljs-comment" style="color: green;"># Average return time</span>
mean(walkRes[walkRes &gt; -<span class="hljs-number">1</span>])
<span class="hljs-comment" style="color: green;"># Number of infinite spirals</span>
sum(walkRes == -<span class="hljs-number">1</span>)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Average return time
> mean(walkRes[walkRes > -1] )
[1] 66.03823
> # Number of infinite spirals
> sum(walkRes == -1)
[1] 6
</pre>
<br /><br />
<b>(b)</b><br >
As expected, the mean time to retun to 0 is much higher for a random 2D walk.
Out of the 1000 simulations, 223 did not return to 0 within the first 10000 steps that were done.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 17b - Random Walk in 2D</span>

RandomWalk2D &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>() {
    NSTEPS = <span class="hljs-number">100000</span>
    walkDirectionX = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = NSTEPS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    walkDirectionY = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = NSTEPS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    backX = cumsum(walkDirectionX)
    backY = cumsum(walkDirectionY)
    <span class="hljs-comment" style="color: green;"># Did simulation not return?</span>
    returned = <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>
    k = <span class="hljs-number">0</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">while</span> (k &lt; NSTEPS &amp; returned == <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>)  {
    k = k + <span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (backX[k] == <span class="hljs-number">0</span> &amp; backY[k] == <span class="hljs-number">0</span>) {
        returned = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>
    }
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(returned) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(k)
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(-<span class="hljs-number">1</span>)
    } 
}

NWALKS = <span class="hljs-number">1000</span>
walkRes = rep(<span class="hljs-number">0</span>, NWALKS)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NWALKS) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (i %% <span class="hljs-number">100</span> == <span class="hljs-number">0</span>) print(i)
    walkRes[i]= RandomWalk2D()
}
<span class="hljs-comment" style="color: green;"># Average return time</span>
mean(walkRes[walkRes &gt; -<span class="hljs-number">1</span>])
<span class="hljs-comment" style="color: green;"># Number of infinite spirals</span>
sum(walkRes == -<span class="hljs-number">1</span>)</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Average return time
> mean(walkRes[walkRes > -1])
[1] 2389.346
> # Number of infinite spirals
> sum(walkRes == -1)
[1] 223
</pre>
<br /><br />
<b>(c)</b><br >
With just a few modifications we can adjust the previous program to a 3D random walk. The results show that
almost 3/4 of the simulated walks did not return to 0. Of those that did, the return time is a bit shorter
than for the 2D walk.
<br /><br />
Based on the limited simulations we are able to do, it is very hard to determine that the walks will always
return for 1D and 2D walks, but not necessarily for 3D walks.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 01.01 - Exercise 17c - Random Walk in 3D</span>

RandomWalk3D &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>() {
    NSTEPS = <span class="hljs-number">100000</span>
    walkDirectionX = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = NSTEPS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    walkDirectionY = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = NSTEPS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    walkDirectionZ = sample(c(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>), size = NSTEPS, replace = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>)
    backX = cumsum(walkDirectionX)
    backY = cumsum(walkDirectionY)
    backZ = cumsum(walkDirectionZ)
    <span class="hljs-comment" style="color: green;"># Did simulation not return?</span>
    returned = <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>
    k = <span class="hljs-number">0</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">while</span> (k &lt; NSTEPS &amp; returned == <span class="hljs-literal" style="color: rgb(163, 21, 21);">FALSE</span>)  {
    k = k + <span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (backX[k] == <span class="hljs-number">0</span> &amp; backY[k] == <span class="hljs-number">0</span> &amp; backZ[k] == <span class="hljs-number">0</span>) {
        returned = <span class="hljs-literal" style="color: rgb(163, 21, 21);">TRUE</span>
    }
    }
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(returned) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(k)
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(-<span class="hljs-number">1</span>)
    } 
}

NWALKS = <span class="hljs-number">1000</span>
walkRes = rep(<span class="hljs-number">0</span>, NWALKS)
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NWALKS) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (i %% <span class="hljs-number">100</span> == <span class="hljs-number">0</span>) print(i)
    walkRes[i]= RandomWalk3D()
}
<span class="hljs-comment" style="color: green;"># Average return time</span>
mean(walkRes[walkRes &gt; -<span class="hljs-number">1</span>])
<span class="hljs-comment" style="color: green;"># Number of infinite spirals</span>
sum(walkRes == -<span class="hljs-number">1</span>)</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # Average return time
> mean(walkRes[walkRes > -1])
[1] 336.5551
> # Number of infinite spirals
> sum(walkRes == -1)
[1] 737
</pre>
<div class="exend">&#9632;</div>
<br /><br />


<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
</div><!-- End page div-->
</body>
</html>

