<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="styling.css">
    <script>
        MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
            fontCache: 'global'
        }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <title>Chapter 2 - 2.1</title> <!-- #################### TITLE #################### -->
</head>
\(
   \def\R{\mathbb{R}}
   \def\N{\mathbb{N}}
   \def\Z{\mathbb{Z}}
   \def\Q{\mathbb{Q}}
   \def\eps{\varepsilon}
   \def\epsilon{\varepsilon}
   \renewcommand{\geq}{\geqslant}
   \renewcommand{\leq}{\leqslant}
\)
<body>
    <div class="page">
<h1>Chapter 2 - Continuous Probability Densities</h1>

<h2>2.1 Simulation of Continuous Probabilities</h2>
<br />
<table border="0">
    <tr>
        <td><b>Main</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Previous</b>:</td>
        <td><a href="ch01_01.02_DiscProbDist.html">1.2 Discrete Probability Distributions</a></td>
    </tr>
    <tr>
        <td><b>Next</b>:</td>
        <td><a href="ch02_02.02_ContProbDens.html">2.2 Continuous Density Functions</a></td>
    </tr>
</table>
<br /><br /><br /><br />


<!-- ########################### EXERCISES ########################### -->


<!--
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
-->

<!-- P. 60 -->
<h3>Exercise 1</h3>
In the spinner problem (see Example 2.1) divide the unit circumference into
three arcs of length 1/2, 1/3, and 1/6. Write a program to simulate the
spinner experiment 1000 times and print out what fraction of the outcomes
fall in each of the three arcs. Now plot a bar graph whose bars have width 1/2,
1/3, and 1/6, and areas equal to the corresponding fractions as determined
by your simulation. Show that the heights of the bars are all nearly the same.
<br /><br />
<i>Answer</i><br /><br />
Result:<br />
<img src="img/02.01_Ex01.png" /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 02.01 - Exercise 1 - Spinner</span>

<span class="hljs-comment" style="color: green;"># Simply simulate values between [0, 1].</span>
NSIM = <span class="hljs-number">1000</span>
simVals = runif(NSIM)

<span class="hljs-comment" style="color: green;"># Arc1:   0 to 1/2</span>
A1 = sum(simVals &lt; <span class="hljs-number">1</span>/<span class="hljs-number">2</span>)/NSIM
<span class="hljs-comment" style="color: green;"># Arc2: 1/2 to 5/6</span>
A2 = sum(simVals &gt; <span class="hljs-number">1</span>/<span class="hljs-number">2</span> &amp; simVals &lt; <span class="hljs-number">5</span>/<span class="hljs-number">6</span>)/NSIM
<span class="hljs-comment" style="color: green;"># Arc3: 5/6 to 1</span>
A3 = sum(simVals &gt; <span class="hljs-number">5</span>/<span class="hljs-number">6</span>)/NSIM

A1;A2;A3

<span class="hljs-comment" style="color: green;"># create dummy data</span>
df &lt;- data.frame(
    name=c(<span class="hljs-string" style="color: rgb(163, 21, 21);">"A1"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A2"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A3"</span>),
    value=c(A1, A2, A3),
    area = c(<span class="hljs-number">2</span>*A1, <span class="hljs-number">3</span>*A2, <span class="hljs-number">6</span>*A3)
)

<span class="hljs-comment" style="color: green;"># Control width:</span>
barplot(height=df$area, names=df$name, col=rgb(<span class="hljs-number">0.2</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.6</span>,<span class="hljs-number">0.6</span>), width=c(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>,<span class="hljs-number">1</span>/<span class="hljs-number">3</span>,<span class="hljs-number">1</span>/<span class="hljs-number">6</span>),
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Adjusted bar plot"</span>)

png(filename = <span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/02.01_Ex01.png"</span>,
    width = <span class="hljs-number">640</span>, height=<span class="hljs-number">480</span>)
barplot(height=df$area, names=df$name, col=rgb(<span class="hljs-number">0.2</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.6</span>,<span class="hljs-number">0.6</span>), width=c(<span class="hljs-number">1</span>/<span class="hljs-number">2</span>,<span class="hljs-number">1</span>/<span class="hljs-number">3</span>,<span class="hljs-number">1</span>/<span class="hljs-number">6</span>),
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Adjusted bar plot"</span>)
dev.off()
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> A1;A2;A3
[1] 0.493
[1] 0.34
[1] 0.167
</pre>
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 2</h3>
Do the same as in Exercise 1, but divide the unit circumference into five arcs
of length 1/3, 1/4, 1/5, 1/6, and 1/20.
<br /><br />
<i>Answer</i><br /><br />
Result:<br />
<img src="img/02.01_Ex02.png" /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 02.01 - Exercise 2 - Spinner II</span>

<span class="hljs-comment" style="color: green;"># Simply simulate values between [0, 1].</span>
<span class="hljs-comment" style="color: green;"># 1/3, 1/4, 1/5, 1/6, and 1/20</span>
NSIM = <span class="hljs-number">10000</span>
simVals = runif(NSIM)

<span class="hljs-comment" style="color: green;"># Arc1:</span>
A1 = sum(simVals &lt; <span class="hljs-number">1</span>/<span class="hljs-number">3</span>)/NSIM
<span class="hljs-comment" style="color: green;"># Arc2:</span>
A2 = sum(simVals &gt; <span class="hljs-number">1</span>/<span class="hljs-number">3</span> &amp; simVals &lt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span>))/NSIM
<span class="hljs-comment" style="color: green;"># Arc3:</span>
A3 = sum(simVals &gt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span>) &amp; simVals &lt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span> + <span class="hljs-number">1</span>/<span class="hljs-number">5</span>))/NSIM
<span class="hljs-comment" style="color: green;"># Arc4:</span>
A4 = sum(simVals &gt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span> + <span class="hljs-number">1</span>/<span class="hljs-number">5</span>) &amp; simVals &lt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span> + <span class="hljs-number">1</span>/<span class="hljs-number">5</span> + <span class="hljs-number">1</span>/<span class="hljs-number">6</span>))/NSIM
<span class="hljs-comment" style="color: green;"># Arc5:</span>
A5 = sum(simVals &gt; (<span class="hljs-number">1</span>/<span class="hljs-number">3</span> + <span class="hljs-number">1</span>/<span class="hljs-number">4</span> + <span class="hljs-number">1</span>/<span class="hljs-number">5</span> + <span class="hljs-number">1</span>/<span class="hljs-number">6</span>))/NSIM

A1;A2;A3;A4;A5

<span class="hljs-comment" style="color: green;"># create dummy data</span>
df &lt;- data.frame(
    name=c(<span class="hljs-string" style="color: rgb(163, 21, 21);">"A1"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A2"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A3"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A4"</span>, <span class="hljs-string" style="color: rgb(163, 21, 21);">"A5"</span>),
    value=c(A1, A2, A3, A4, A5),
    area = c(<span class="hljs-number">3</span>*A1, <span class="hljs-number">4</span>*A2, <span class="hljs-number">5</span>*A3, <span class="hljs-number">6</span>*A4, <span class="hljs-number">20</span>*A5)
)

<span class="hljs-comment" style="color: green;"># Control width:</span>
barplot(height=df$area, names=df$name, col=rgb(<span class="hljs-number">0.2</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.6</span>,<span class="hljs-number">0.6</span>), width=c(<span class="hljs-number">1</span>/<span class="hljs-number">3</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">5</span>,<span class="hljs-number">1</span>/<span class="hljs-number">6</span>,<span class="hljs-number">1</span>/<span class="hljs-number">20</span>),
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Adjusted bar plot"</span>)

png(filename = <span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/02.01_Ex02.png"</span>,
    width = <span class="hljs-number">640</span>, height=<span class="hljs-number">480</span>)
barplot(height=df$area, names=df$name, col=rgb(<span class="hljs-number">0.2</span>,<span class="hljs-number">0.4</span>,<span class="hljs-number">0.6</span>,<span class="hljs-number">0.6</span>), width=c(<span class="hljs-number">1</span>/<span class="hljs-number">3</span>,<span class="hljs-number">1</span>/<span class="hljs-number">4</span>,<span class="hljs-number">1</span>/<span class="hljs-number">5</span>,<span class="hljs-number">1</span>/<span class="hljs-number">6</span>,<span class="hljs-number">1</span>/<span class="hljs-number">20</span>),
        main=<span class="hljs-string" style="color: rgb(163, 21, 21);">"Adjusted bar plot"</span>)
dev.off()
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> A1;A2;A3;A4;A5
[1] 0.3325
[1] 0.2501
[1] 0.1964
[1] 0.1727
[1] 0.0483
</pre>
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 3</h3>
Alter the program <b>MonteCarlo</b> to estimate the area of the circle of radius
1/2 with center at (1/2, 1/2) inside the unit square by choosing 1000 points
at random. Compare your results with the true value of π/4. Use your results
to estimate the value of π. How accurate is your estimate?
<br /><br />
<i>Answer</i><br /><br />
Did a few simulations and the estimate for $\pi$ varied a bit. One good simulation gave 3.156. This could be
made better by increasing the number of simulated points.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 02.01 - Exercise 3 - Estimating pi</span>

NVALS = <span class="hljs-number">1000</span>
vlsX = runif(NVALS)
vlsY = runif(NVALS)

<span class="hljs-comment" style="color: green;"># Determine values within circle at (1/2, 1/2) with radius 1/2</span>

hit = <span class="hljs-number">0</span>
hitCoords = c()
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NVALS) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> ((vlsX[k]-<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^<span class="hljs-number">2</span> + (vlsY[k]-<span class="hljs-number">1</span>/<span class="hljs-number">2</span>)^<span class="hljs-number">2</span> &lt;= <span class="hljs-number">1</span>/<span class="hljs-number">4</span>) {
        hit = hit + <span class="hljs-number">1</span>
        hitCoords = c(hitCoords, k)
    }
}
hit
length(hitCoords)

xCirc = vlsX[hitCoords]
yCirc = vlsY[hitCoords]
xOut = vlsX[-hitCoords]
yOut = vlsY[-hitCoords]

png(filename = <span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/02.01_Ex03.png"</span>,
    width=<span class="hljs-number">400</span>, height=<span class="hljs-number">400</span>)
plot(xCirc, yCirc, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
points(xOut, yOut, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
dev.off()

<span class="hljs-comment" style="color: green;">#pi/4</span>
hit/<span class="hljs-number">1000</span>
<span class="hljs-comment" style="color: green;">#pi</span>
<span class="hljs-number">4</span>*hit/<span class="hljs-number">1000</span></pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> hit/1000
[1] 0.789
> #pi
> 4*hit/1000
[1] 3.156
</pre><br />
<img src="img/02.01_Ex03.png" />
<div class="exend">&#9632;</div>
<br /><br />




<h3>Exercise 4</h3>
Alter the program <b>MonteCarlo</b> to estimate the area under the graph of
$y = \sin \pi x$ inside the unit square by choosing 10,000 points at random. Now
calculate the true value of this area and use your results to estimate the value
of π. How accurate is your estimate?
<br /><br />
<i>Answer</i><br />
Calculating the true value of the area in the interval [0, 1].
\begin{align}
\int_0^1\sin(\pi x)dx
&= \left[-\frac{1}{\pi}\cos(\pi x)\right]_0^1 \\
&= -\frac{1}{\pi}\cos(\pi) + \frac{1}{\pi}\cos(0) \\
&= \frac{1}{\pi} + \frac{1}{\pi} \\
&= \frac{2}{\pi}
\end{align}
The estimate for $2/\pi$ is quite close and the estimate for $\pi$ is around 3.137747.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 02.01 - Exercise 4 - Estimating sin(pi*x)</span>

NVALS = <span class="hljs-number">10000</span>
vlsX = runif(NVALS)
vlsY = runif(NVALS)

<span class="hljs-comment" style="color: green;"># Determine values within circle at (1/2, 1/2) with radius 1/2</span>

hit = <span class="hljs-number">0</span>
hitCoords = c()
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NVALS) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (vlsY[k] &lt;= sin(pi*vlsX[k])) {
        hit = hit + <span class="hljs-number">1</span>
        hitCoords = c(hitCoords, k)
    }
}
hit
length(hitCoords)

xSin = vlsX[hitCoords]
ySin = vlsY[hitCoords]
xOut = vlsX[-hitCoords]
yOut = vlsY[-hitCoords]

plot(xSin, ySin, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
points(xOut, yOut, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)

png(filename = <span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/02.01_Ex04.png"</span>,
    width=<span class="hljs-number">400</span>, height=<span class="hljs-number">400</span>)
plot(xSin, ySin, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
points(xOut, yOut, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
dev.off()

<span class="hljs-comment" style="color: green;"># 2/pi</span>
hit/NVALS
<span class="hljs-number">2</span>/pi
(hit/NVALS)/(<span class="hljs-number">2</span>/pi)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # 2/pi
> hit/NVALS
[1] 0.6374
> 2/pi
[1] 0.6366198
> (hit/NVALS)/(2/pi)
[1] 1.001226
> 
> # pi
> 2/(hit/NVALS)
[1] 3.137747
</pre><br />
<img src="img/02.01_Ex04.png" />
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 5</h3>
Alter the program <b>MonteCarlo</b> to estimate the area under the graph of
$y = 1/(x + 1)$ in the unit square in the same way as in Exercise 4. Calculate
the true value of this area and use your simulation results to estimate the
value of $\ln 2$. How accurate is your estimate?
<br /><br />
<i>Answer</i><br /><br />
Calculating the true value.
\begin{align}
\int_0^1 \frac{1}{x + 1}dx
&= \Big[\ln(x + 1)\Big]_0^1 \\
&= \ln(2) - \ln(1) \\
&= \ln(2) \\
&\approx 0.6931472
\end{align}
Estimated value is 0.6939, which is close to the approximated true value, 0.6931472. As shown below the simulated
estimate is within 0.1% of the true value.
<br /><br />
<b>Code</b>
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 02.01 - Exercise 5 - Estimating ln(2)</span>

NVALS = <span class="hljs-number">10000</span>
vlsX = runif(NVALS)
vlsY = runif(NVALS)

hit = <span class="hljs-number">0</span>
hitCoords = c()
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (k <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:NVALS) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (vlsY[k] &lt;= <span class="hljs-number">1</span>/(vlsX[k] + <span class="hljs-number">1</span>)) {
        hit = hit + <span class="hljs-number">1</span>
        hitCoords = c(hitCoords, k)
    }
}
hit
length(hitCoords)

xLog = vlsX[hitCoords]
yLog = vlsY[hitCoords]
xOut = vlsX[-hitCoords]
yOut = vlsY[-hitCoords]

plot(xLog, yLog, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
points(xOut, yOut, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)

png(filename = <span class="hljs-string" style="color: rgb(163, 21, 21);">"~/GITHUB/CoveredInChocolate.github.io/IntroProb/img/02.01_Ex05.png"</span>,
    width=<span class="hljs-number">400</span>, height=<span class="hljs-number">400</span>)
plot(xLog, yLog, col=<span class="hljs-string" style="color: rgb(163, 21, 21);">"red"</span>, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
points(xOut, yOut, pch=<span class="hljs-number">16</span>, cex=<span class="hljs-number">0.8</span>)
dev.off()

<span class="hljs-comment" style="color: green;"># log(2)</span>
hit/NVALS
log(<span class="hljs-number">2</span>)
(hit/NVALS)/log(<span class="hljs-number">2</span>)
</pre>
</div>
<br />
<b>Output</b>
<pre class="rcode">
> # log(2)
> hit/NVALS
[1] 0.6939
> log(2)
[1] 0.6931472
> (hit/NVALS)/log(2)
[1] 1.001086
</pre><br />
<img src="img/02.01_Ex05.png" />
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 6</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 7</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 8</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 9</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />





<h3>Exercise 10</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 11</h3>
asd
<br /><br />
<i>Answer</i><br /><br />
<b>Code</b>
<div class="rcode">

</div>
<br />
<b>Output</b>
<pre class="rcode">

</pre>
<div class="exend">&#9632;</div>
<br /><br />

<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
</div><!-- End page div-->
</body>
</html>

