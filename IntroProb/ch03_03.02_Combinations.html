<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="styling.css">
    <script>
        MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
            fontCache: 'global'
        }
        };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/javascript" id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
    <title>Chapter 3 - 3.2</title> <!-- #################### TITLE #################### -->
</head>
\(
   \def\R{\mathbb{R}}
   \def\N{\mathbb{N}}
   \def\Z{\mathbb{Z}}
   \def\Q{\mathbb{Q}}
   \def\eps{\varepsilon}
   \def\epsilon{\varepsilon}
   \renewcommand{\geq}{\geqslant}
   \renewcommand{\leq}{\leqslant}
\)
<body>
    <div class="page">
        <h1>Chapter 3 - Combinatorics</h1>

        <h2>3.2 Combinations</h2>
<br />
<table border="0">
    <tr>
        <td><b>Main</b>:</td>
        <td><a href="index.html">Index</a></td>
    </tr>
    <tr>
        <td><b>Previous</b>:</td>
        <td><a href="ch03_03.01_Permutations.html">3.1 Permutations</a></td>
    </tr>
    <tr>
        <td><b>Next</b>:</td>
        <td><a href="_TEMPLATE.html">4.1 Discrete Conditional Probability</a></td>
    </tr>
</table>
<br /><br />

<h3>Results</h3>

<div class="thm">Combinations</div><br />
Imagine a set A with n elements. A <i>combination</i> of size k can be thought of as the all subsets
of A with length k. Example: A = {a, b, c}. Then the set of all possible subsets are:
$$
\{\emptyset, \{a\}, \{b\}, \{c\}, \{a, b\}, \{a, c\}, \{b, c\}, \{a, b, c\}\}.
$$
All possible combinations of length 2 are: {a, b}, {a, c} or {b, c}. For combinations the order doesn't
matter; {a, b} and {b, a} are the same subset.
<br /><br /><br /><br />

<div class="thm">Theorem 3.4</div><br />
For integers n and k with 0 < k < n, the binomial coefficients satisfy:
$$
\binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}.
\tag{3.1}
$$
We use the initial condition:
$$
\binom{n}{0} = \binom{n}{n} = 1  
$$
which uniquely determines Pascal's triangle.
<br /><br /><br /><br />

<div class="thm">Theorem 3.5</div><br />
The binomial coefficients are given by the formula:
$$
\binom{n}{k} = \frac{n!}{k!(n-k)!}.
\tag{3.2}
$$
It immediately follows that:
$$
\binom{n}{k} = \binom{n}{n-k}
$$
<br /><br /><br /><br />

<div class="thm">Definition 3.5</div><br />
A <i>Bernoulli trials process</i> is a sequence of n chance experiments such that
<br /><br />
<div class="indent">
    1. Each experiment has two possible outcomes, which we can call <i>success</i> and <i>failure</i>.
    <br /><br />
    2. The probability p of success on each experiment is the same for each experiment, and this
    probability is not affected by any knowledge of previous outcomes. The probability q of failure
    is given by q = 1 - p.
</div>
<br /><br /><br /><br />

<div class="thm">Theorem 3.6</div><br />
Given n Bernoulli trials with probability p of success on each experiment, the probability of
exactly k successes is
$$
b(n, p, k) = \binom{n}{k}p^kq^{n-k}
$$
where q = 1-p.
<br /><br /><br /><br />

<div class="thm">Definition 3.6</div><br />
Let n be a positive integer and let p be a real number between 0 and 1. Let B be the random variable
which counts the number of successes in a Bernoulli trials process with parameters n and p. Then the
distribution b(n, p, k) of B is called the <i>binomial distribution</i>.
<br /><br /><br /><br />

<div class="thm">Theorem 3.7 (Binomial Theorem)</div><br />
The quantity (a + b)<sup>n</sup> can be expressed in the form
$$
(a + b)^n = \sum_{k=0}^n\binom{n}{k}a^kb^{n-k}.
$$
<br /><br /><br /><br />


<br /><br /><br /><br />


<!-- ########################### EXERCISES ########################### -->


<!--
<br /><br />
<b>Code</b>:<br />
<div class="rcode">

</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">

</pre>
-->


<!-- p 121 -->
<h3>Exercise 1</h3>
Compute the following:
<br /><br />
<b>(a)</b> binom(6, 3)<br />
<b>(b)</b> b(5, .2, 4)<br />
<b>(c)</b> binom(7, 2)<br />
<b>(d)</b> binom(26, 26)<br />
<b>(e)</b> b(4, .2, 3)<br />
<b>(f)</b> binom(6, 2)<br />
<b>(g)</b> binom(10, 9)<br />
<b>(h)</b> b(8, .3, 5)<br />
<br /><br />
<i>Answer</i><br />
<br /><br />
<b>(a)</b><br />
binom(6, 3) = 20
<br /><br />
<b>(b)</b><br />
$$
b(5, .2, 4) = \binom{5}{4}(0.2)^4(0.8) = 5(0.2)^4(0.8) = 0.0064.
$$
<br /><br />
<b>(c)</b><br />
binom(7, 2) = 21
<br /><br />
<b>(d)</b><br />
binom(26, 26) = 1
<br /><br />
<b>(e)</b><br />
$$
b(4, .2, 3) = \binom{4}{3}(0.2)^3(0.8) = 4(0.2)^3(0.8) = 0.0256.
$$
<br /><br />
<b>(f)</b><br />
binom(6, 2) = 15
<br /><br />
<b>(g)</b><br />
binom(10, 9) = 10
<br /><br />
<b>(h)</b><br />
$$
b(8, .3, 5) = \binom{8}{5}(0.3)^5(0.7)^3 = 56(0.3)^5(0.7)^3 = 0.04667544.
$$
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 2</h3>
In how many ways can we choose five people from a group of ten to form a
committee?
<br /><br />
<i>Answer</i><br />
How many possible subsets of 5 elements can be drawn from a set with 10 elements.
$$
\binom{10}{5} = \frac{10!}{5!5!} = 252.
$$
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 3</h3>
How many seven-element subsets are there in a set of nine elements?
<br /><br />
<i>Answer</i><br />
binom(9,7) = 9!/(2!7!) = 36.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 4</h3>
Using the relation Equation 3.1 write a program to compute Pascal’s triangle,
putting the results in a matrix. Have your program print the triangle for
n = 10.
<br /><br />
<i>Answer</i><br />
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 4 - Binomial Triangle</span>
ntot = <span class="hljs-number">11</span>

pascalsTriangle = matrix(rep(<span class="hljs-number">0</span>, ntot**<span class="hljs-number">2</span>), ncol=ntot)

<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:ntot) {
    n = i-<span class="hljs-number">1</span>
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span> (n &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (j <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:i) {
            k = j-<span class="hljs-number">1</span>
            pascalsTriangle[i, j] = choose(n, k)
        }
    } <span class="hljs-keyword" style="color: rgb(0, 0, 255);">else</span> {
        <span class="hljs-comment" style="color: green;"># First row</span>
        pascalsTriangle[<span class="hljs-number">1</span>, <span class="hljs-number">1</span>] = choose(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
    }
}

<span class="hljs-comment" style="color: green;"># Nicer output</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (i <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:ntot) {
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (j <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">1</span>:ntot) {
        <span class="hljs-keyword" style="color: rgb(0, 0, 255);">if</span>(pascalsTriangle[i, j] != <span class="hljs-number">0</span>) {
            cat(sprintf(<span class="hljs-string" style="color: rgb(163, 21, 21);">"%6d"</span>, pascalsTriangle[i, j]))
        }
    }
    cat(<span class="hljs-string" style="color: rgb(163, 21, 21);">"\n"</span>)
}
</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
    1
    1     1
    1     2     1
    1     3     3     1
    1     4     6     4     1
    1     5    10    10     5     1
    1     6    15    20    15     6     1
    1     7    21    35    35    21     7     1
    1     8    28    56    70    56    28     8     1
    1     9    36    84   126   126    84    36     9     1
    1    10    45   120   210   252   210   120    45    10     1
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 5</h3>
Write a program to find the probability that, in 100
tosses of a fair coin, the number of heads that turns up lies between 35 and
65, between 40 and 60, and between 45 and 55.
<br /><br />
<i>Answer</i><br />
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 5 - Many coin flips</span>

b &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(n, p, k) {
    q = <span class="hljs-number">1</span> - p
    prob = choose(n, k)*p**k*q**(n-k)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(prob)
}

N = <span class="hljs-number">100</span>
prob1 = <span class="hljs-number">0</span>
prob2 = <span class="hljs-number">0</span>
prob3 = <span class="hljs-number">0</span>

<span class="hljs-comment" style="color: green;"># Between 35 and 65</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (heads <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">35</span>:<span class="hljs-number">65</span>) {
    prob1 = prob1 + b(N, <span class="hljs-number">0.5</span>, heads)
}
<span class="hljs-comment" style="color: green;"># Between 40 and 60</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (heads <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">40</span>:<span class="hljs-number">60</span>) {
    prob2 = prob2 + b(N, <span class="hljs-number">0.5</span>, heads)
}
<span class="hljs-comment" style="color: green;"># Between 45 and 55</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (heads <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> <span class="hljs-number">45</span>:<span class="hljs-number">55</span>) {
    prob3 = prob3 + b(N, <span class="hljs-number">0.5</span>, heads)
}

<span class="hljs-comment" style="color: green;"># Probabilities</span>
prob1
prob2
prob3

</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
> # Probabilities
> prob1
[1] 0.9982101
> prob2
[1] 0.9647998
> prob3
[1] 0.728747
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 6</h3>
Charles claims that he can distinguish between beer and ale 75 percent of the
time. Ruth bets that he cannot and, in fact, just guesses. To settle this, a bet
is made: Charles is to be given ten small glasses, each having been filled with
beer or ale, chosen by tossing a fair coin. He wins the bet if he gets seven or
more correct. Find the probability that Charles wins if he has the ability that
he claims. Find the probability that Ruth wins if Charles is guessing.
<br /><br />
<i>Answer</i><br />
This is a binomial experiment. If Charles has the ability to distinguish beer from ale
his success rate is 0.75. Let X be the number of correct guesses, then we have:
$$
P(X = k) = \binom{10}{k}(0.75)^k(0.25)^{10-k}
$$
Charles wins if:
$$
P(X\geq 7) = P(X = 10) + P(X = 9) + P(X = 8) + P(X = 7)
$$
Calculating in R.
<pre class="rcode">
# Using b() from previous exercise
# Between 7 and 10
probCharles = 0
for (correct in 7:10) {
  probCharles = probCharles + b(10, 0.75, correct)
}
> probCharles
[1] 0.7758751
</pre>
If Charles is guessing, his probability of success falls to 0.5. Calculating the probability.
<pre class="rcode">
# Using b() from previous exercise
# Between 0 and 6
probRuth = 0
for (correct in 0:6) {
  probRuth = probRuth + b(10, 0.5, correct)
}
> probRuth
[1] 0.828125
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 7</h3>
Show that
$$
b(n, p, k) = \frac{p}{q}\left(\frac{n - k + 1}{k}\right)b(n, p, k-1)
$$
for j greater or equal to 1. <i>Hint</i>: Consider the successive ratios as j increases.
<b>Note</b>: <i>This is a fraction and not a binomial coefficient!</i> :)
<br /><br />
<i>Answer</i><br />
\begin{align}
b(n, p, k) &= \binom{n}{k}p^kq^{n-k}
\\&\\
&= \frac{n!}{(n-k)!k!}\cdot p^{k-1}q^{n-k+1}\cdot\frac{p}{q}
\\&\\
&= \frac{p}{q}\cdot\frac{n!}{(n-k)!k!}\cdot\frac{(n-k+1)!(k-1)!}{n!}\cdot\binom{n}{k-1}\cdot p^{k-1}q^{n-(k-1)}
\\&\\
&= \frac{p}{q}\cdot\frac{n!}{(n-k)!k!}\cdot\frac{(n-k+1)!(k-1)!}{n!}\cdot b(n, p, k-1)
\\&\\
&= \frac{p}{q}\cdot\frac{(n-k+1)!(k-1)!}{(n-k)!k!}\cdot b(n, p, k-1)
\\&\\
&= \frac{p}{q}\left(\frac{n-k+1}{k}\right)b(n, p, k-1)
\end{align}
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 8</h3>
A die is rolled 30 times. What is the probability that a 6 turns up exactly 5
times? What is the most probable number of times that a 6 will turn up?
<br /><br />
<i>Answer</i><br />
Another binomial experiment where X is the number of sixes with a success rate of p = 1/6.
$$
P(X = 5) = \binom{30}{5}(1/6)^5(5/6)^{25} = 0.1921081.
$$
<br /><br />
The distribution of binomial experiments are quite symmetrical around the expected value, which
in this case is (30)(1/6) = 5, so this is the most probable outcome. We can check this by
calculating the values for 4 and 6 sixes. We see that this is correct below.
<pre class="rcode">
> choose(30, 6)*(1/6)**6*(5/6)**24
[1] 0.1600901

> choose(30, 4)*(1/6)**4*(5/6)**26
[1] 0.1847194
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 9</h3>
Find integers n and r such that the following equation is true:
$$
\binom{13}{5} + 2\binom{13}{6} + \binom{13}{7} = \binom{n}{r}.
$$
<br /><br />
<i>Answer</i><br />
This is just applying Theorem 3.5 several times.
\begin{align}
\binom{13}{5} + 2\binom{13}{6} + \binom{13}{7} &=
\binom{13}{5} + \binom{13}{6} + \binom{13}{6} + \binom{13}{7}
\\&\\
&= \binom{14}{6} + \binom{14}{7}
\\&\\
&= \binom{15}{7}.
\end{align}
<br /><br />
Confirming in R.
<pre class="rcode">
> choose(13, 5) + 2*choose(13, 6) + choose(13,7)
[1] 6435

> choose(15, 7)
[1] 6435
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 10</h3>
In a ten-question true-false exam, find the probability that a student gets a
grade of 70 percent or better by guessing. Answer the same question if the
test has 30 questions, and if the test has 50 questions.
<br /><br />
<i>Answer</i><br />
Binomial experiment, where we need at least 7, 21 and 35 correct to get at least 70%. (The probabilities
get progressively worse as the size of the test increases).
\begin{align}
P(T_1 \geq 7) &= \sum_{k=7}^{10}\binom{10}{k}(0.5)^{k}(0.5)^{10-k}
\\&\\
P(T_2 \geq 21) &= \sum_{k=21}^{30}\binom{30}{k}(0.5)^{k}(0.5)^{30-k}
\\&\\
P(T_3 \geq 35) &= \sum_{k=35}^{50}\binom{50}{k}(0.5)^{k}(0.5)^{50-k}
\end{align}
<br /><br />
Will calculate in R.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 10 - Test Guessing</span>

<span class="hljs-comment" style="color: green;"># Binomial Distribution</span>
b &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(n, p, k) {
    q = <span class="hljs-number">1</span> - p
    prob = choose(n, k)*p**k*q**(n-k)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(prob)
}

<span class="hljs-comment" style="color: green;"># Test: 7 to 10</span>
probT1 = <span class="hljs-number">0</span>
minQst = <span class="hljs-number">7</span>
totQst = <span class="hljs-number">10</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (correct <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> minQst:totQst) {
    probT1 = probT1 + b(totQst, <span class="hljs-number">0.5</span>, correct)
}

<span class="hljs-comment" style="color: green;"># Test: 21 to 30</span>
probT2 = <span class="hljs-number">0</span>
minQst = <span class="hljs-number">21</span>
totQst = <span class="hljs-number">30</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (correct <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> minQst:totQst) {
    probT2 = probT2 + b(totQst, <span class="hljs-number">0.5</span>, correct)
}

<span class="hljs-comment" style="color: green;"># Test: 35 to 50</span>
probT3 = <span class="hljs-number">0</span>
minQst = <span class="hljs-number">35</span>
totQst = <span class="hljs-number">50</span>
<span class="hljs-keyword" style="color: rgb(0, 0, 255);">for</span> (correct <span class="hljs-keyword" style="color: rgb(0, 0, 255);">in</span> minQst:totQst) {
    probT3 = probT3 + b(totQst, <span class="hljs-number">0.5</span>, correct)
}

probT1
probT2
probT3
</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
> probT1
[1] 0.171875

> probT2
[1] 0.02138697

> probT3
[1] 0.003300224
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 11</h3>
A restaurant offers apple and blueberry pies and stocks an equal number of
each kind of pie. Each day ten customers request pie. They choose, with
equal probabilities, one of the two kinds of pie. How many pieces of each kind
of pie should the owner provide so that the probability is about .95 that each
customer gets the pie of his or her own choice?
<br /><br />
<i>Answer</i><br />
Start with 10 pies of one kind, and remove them one at a time until we pass the 0.95 mark.
Calculating in R. As we see, if we remove 3 pies, there is a 95% that there won't be enough pies.
So the restaurant should have 8 of each.
<br /><br />
<pre class="rcode">
# Binomial Distribution
b <- function(n, p, k) {
    q = 1 - p
    prob = choose(n, k)*p**k*q**(n-k)
    return(prob)
}

1 - b(10, 0.5, 10)
1 - (b(10, 0.5, 10) + b(10, 0.5, 9))
1 - (b(10, 0.5, 10) + b(10, 0.5, 9) + b(10, 0.5, 8))

> 1 - b(10, 0.5, 10)
[1] 0.9990234
> 1 - (b(10, 0.5, 10) + b(10, 0.5, 9))
[1] 0.9892578
> 1 - (b(10, 0.5, 10) + b(10, 0.5, 9) + b(10, 0.5, 8))
[1] 0.9453125
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />





<!-- p 122 -->
<h3>Exercise 12</h3>
A poker hand is a set of 5 cards randomly chosen from a deck of 52 cards.
Find the probability of a
<br /><br />
<b>(a)</b> royal flush (ten, jack, queen, king, ace in a single suit).<br />
<b>(b)</b> straight flush (five in a sequence in a single suit, but not a royal flush).<br />
<b>(c)</b> four of a kind (four cards of the same face value).<br />
<b>(d)</b> full house (one pair and one triple, each of the same face value).<br />
<b>(e)</b> flush (five cards in a single suit but not a straight or royal flush).<br />
<b>(f)</b> straight (five cards in a sequence, not all the same suit). (Note that in<br />
straights, an ace counts high or low.)
<br /><br />
<i>Answer</i><br />
In all cases the possible hands is binom(52, 5). We just have to count the number of ways each of
the hands can be attained to find the probability. (A lot easier than directly calculating probabilities!)
<br /><br />
<b>(a)</b><br />
There are only 4 ways of getting a royal flush. So the probability is 4/binom(52, 5) = 0.00000153907.
<br /><br />
<b>(b)</b><br />
We can get a straight flush in all 4 suits. In each suit, we can get a straight from A to 5 up to and including
10 to A, so 10 straights, but the last type is a royal flush, which we disregard. So 9 straights in each suit
for a total of 4·9 = 36 possibilities. The probability is 36/binom(52, 5) = 0.00001385169. (Exactly 9 times
more likely than the royal flush).
<br /><br />
<b>(c)</b><br />
As explained in the example, there are 13 ways of getting four of a kind, and for the last card there are 48 possible
(all remaining cards). It can happen in 624 ways. The probability is 624/(binom(52, 5) = 0.000240096.
<br /><br />
<b>(d)</b><br />
Also covered in the example. There are 13 ways of getting 3 of a kind, and out of those there are binom(4, 3) = 4
ways. For the remaining pair, there are 12 ways (one value has been discarded in the three of a kind), and
binom(4, 2) = 6 ways of getting them, in total 13·4·12·6 = 3744 ways.
The probability is 3744/binom(52, 5) = 0.001440576.
<br /><br />
<b>(e)</b><br />
A flush can be attained for all 4 suits, and in each suit there are binom(13, 5) = 1287 ways to get the cards needed.
For all four suits, we get 4·1287 = 5148, but this includes royal flush and straight flush, so we remove them
and get 5108 total possibilities. The probability is: (5108)/binom(52, 5) = 0.001965402.
<br /><br />
<b>(f)</b><br />
In this case we only care about consecutive cards and ignore suits. Counting low and high aces, we get
10 possible straights from A-5 up to 10-A. For 10 possible straights, each draw with 4 possible cards
gives a total of 10·4·4·4·4·4 = 10240 possibilities. This includes royal flush and straight flush which
we remove, and get 10200. The probability is 10200/binom(52, 5) = 0.003924647.
<br /><br />
To verify results check here:<br />
<a href="https://en.wikipedia.org/wiki/Poker_probability#Frequency_of_5-card_poker_hands" target="_blank">Wikipedia</a>.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 13</h3>
If a set has 2n elements, show that it has more subsets with n elements than
with any other number of elements.
<br /><br />
<i>Answer</i><br />
The number of sets is determined by the binomial coefficient.
$$
\binom{2n}{n} = \frac{(2n)!}{(2n - n)!n!} = \frac{(2n)!}{n!n!}
$$
Recall that the binomial coefficient is symmetric, so we only have to verify that it gets smaller for
n+1 and n-1.
$$
\binom{2n}{n+1} = \frac{(2n)!}{(2n - (n+1))!(n+1)!} = \frac{(2n)!}{(n+1)!(n-1)!}
$$
$$
\binom{2n}{n-1} = \frac{(2n)!}{(2n - (n-1))!(n-1)!} = \frac{(2n)!}{(n+1)!(n-1)!}
$$
Note that both of these are equal. Now we show that both of these are smaller. We can start with either:
\begin{align}
\binom{2n}{n+1} &= \frac{(2n)!}{(n+1)!(n-1)!}
\\&\\
&= \frac{(2n)(2n-1)\cdots(n+1)(n)(n-1)(n-2)\cdots(1)}{(n+1)(n)(n-1)\cdots(1)\times (n-1)(n-2)\cdots(1)}
\\&\\
&= \frac{(2n)(2n-1)\cdots(n+1)(n)}{(n+1)(n)(n-1)\cdots(1)}
\\&\\
&= \left(\frac{n}{n+1}\right)\frac{(2n)(2n-1)\cdots(n+1)}{(n)(n-1)\cdots(1)}
\\&\\
&= \left(\frac{n}{n+1}\right)\frac{(2n)(2n-1)\cdots(n+1)}{(n)(n-1)\cdots(1)}\cdot\frac{n!}{n!}
\\&\\
&= \left(\frac{n}{n+1}\right)\frac{(2n)!}{n!n!}
\\&\\
&= \left(\frac{n}{n+1}\right)\binom{2n}{n}
\\&\\
&< \binom{2n}{n}
\end{align}
since n/(n+1) < 1. Both sides are smaller, showing that binom(2n, n) is the largest value.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 14</h3>
Let b(2n, 0.5, n) be the probability that in 2n tosses of a fair coin exactly n heads
turn up. Using Stirling’s formula (Theorem 3.3), show that $b(2n, 0.5, n) \sim 1/\sqrt{\pi n}$.
Use a program to compare this with the exact value for n = 10 to 25.
<br /><br />
<i>Answer</i><br />
Showing that the expressions are asymptotically equal.
\begin{align}
b(2n, 0.5, n) &= \binom{2n}{n}(0.5)^n(0.5)^{2n-n}
\\&\\
&= \frac{(2n)!}{n!n!}\left(\frac{1}{2}\right)^{2n}
\\&\\
&= \frac{(2n)!}{n!n!}\left(\frac{1}{2^{2n}}\right)
\\&\\
&\sim \frac{(2n)^{2n}e^{-2n}\sqrt{4\pi n}}{(n^n e^{-n}\sqrt{2\pi n})(n^n e^{-n}\sqrt{2\pi n})}\left(\frac{1}{2^{2n}}\right)
\\&\\
&= \frac{2^{2n}n^{2n}e^{-2n}2\sqrt{\pi n}}{n^{2n} e^{-2n}\cdot 2\pi n}\left(\frac{1}{2^{2n}}\right)
\\&\\
&= \frac{\sqrt{\pi n}}{\pi n}\left(\frac{2^{2n}}{2^{2n}}\right)
\\&\\
&= \frac{1}{\sqrt{\pi n}}
\end{align}
<br /><br />
Instead of all the values proposed, we will check programmatically for n=10, 25, 50.
The approximations are very close.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 14 - Stirling approximation</span>

<span class="hljs-comment" style="color: green;"># Binomial Distribution</span>
b &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(n, p, k) {
    q = <span class="hljs-number">1</span> - p
    prob = choose(n, k)*p**k*q**(n-k)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(prob)
}

n = <span class="hljs-number">10</span>
b(<span class="hljs-number">2</span>*n, <span class="hljs-number">0.5</span>, n)
<span class="hljs-number">1</span>/sqrt(pi*n)

n = <span class="hljs-number">25</span>
b(<span class="hljs-number">2</span>*n, <span class="hljs-number">0.5</span>, n)
<span class="hljs-number">1</span>/sqrt(pi*n)

n = <span class="hljs-number">50</span>
b(<span class="hljs-number">2</span>*n, <span class="hljs-number">0.5</span>, n)
<span class="hljs-number">1</span>/sqrt(pi*n)</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
> n = 10
> b(2*n, 0.5, n)
[1] 0.1761971
> 1/sqrt(pi*n)
[1] 0.1784124

> n = 25
> b(2*n, 0.5, n)
[1] 0.1122752
> 1/sqrt(pi*n)
[1] 0.1128379

> n = 50
> b(2*n, 0.5, n)
[1] 0.07958924
> 1/sqrt(pi*n)
[1] 0.07978846
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 15</h3>
A baseball player, Smith, has a batting average of .300 and in a typical game
comes to bat three times. Assume that Smith’s hits in a game can be considered
to be a Bernoulli trials process with probability .3 for success. Find the
probability that Smith gets 0, 1, 2, and 3 hits.
<br /><br />
<i>Answer</i><br />
Binomial experiment with n=3, p=0.3. Calculating the probabilities in R.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 25 - Baseball simulation</span>

<span class="hljs-comment" style="color: green;"># Binomial Distribution</span>
b &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(n, p, k) {
    q = <span class="hljs-number">1</span> - p
    prob = choose(n, k)*p**k*q**(n-k)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(prob)
}

n = <span class="hljs-number">3</span>
p = <span class="hljs-number">0.3</span>

<span class="hljs-comment" style="color: green;">##### Probability for hits</span>
b(n, p, <span class="hljs-number">0</span>)
b(n, p, <span class="hljs-number">1</span>)
b(n, p, <span class="hljs-number">2</span>)
b(n, p, <span class="hljs-number">3</span>)</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
> ##### Probability for hits
> b(n, p, 0)
[1] 0.343
> b(n, p, 1)
[1] 0.441
> b(n, p, 2)
[1] 0.189
> b(n, p, 3)
[1] 0.027
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 16</h3>
The Siwash University football team plays eight games in a season, winning
three, losing three, and ending two in a tie. Show that the number of ways
that this can happen is:
$$
\binom{8}{3}\binom{5}{3} = \frac{8!}{3!3!2!}.
$$
<br /><br />
<i>Answer</i><br />
They win 3 out of 8 games, which can be done in binom(8, 3) = 56 ways. Of the remaining 5 games
they win 3 which can happen in binom(5, 3) = 10 ways, and finally the 2 draws can happen in
binom(2, 2) = 1 way, so there are a total of 560 possible outcomes.
<br /><br />
Deriving the equation:
$$
\binom{8}{3}\binom{5}{3} = \frac{8!}{5!3!}\cdot\frac{5!}{3!2!} = \frac{8!}{3!3!2!}.
$$
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 17</h3>
Using the technique of Exercise 16, show that the number of ways that one
can put n different objects into three boxes with a in the first, b in the second,
and c in the third is n!/(a!b!c!).
<br /><br />
<i>Answer</i><br />
Placing a objects in the first box can be done in binom(n, a) ways. Placing b in the second box
can be done in binom(n-a, b) ways, and finally the c objects into the third box can be done in
binom(n - a - b, c) ways. Expressing in factorials:
\begin{align}
\binom{n}{a}\binom{n-a}{b} \binom{n-a-b}{c} &=
\frac{n!}{(n-a)!a!}\cdot\frac{(n-a)!}{(n-a-b)!b!}\cdot\frac{(n-a-b)!}{(n-a-b-c)!c!}
\\&\\
&= \frac{n!}{a!}\cdot\frac{1}{b!}\cdot\frac{1}{0!c!}
\\&\\
&= \frac{n!}{a!b!c!}
\end{align}
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 18</h3>
Baumgartner, Prosser, and Crowell are grading a calculus exam. There is a
true-false question with ten parts. Baumgartner notices that one student has
only two out of the ten correct and remarks, “The student was not even bright
enough to have flipped a coin to determine his answers.” “Not so clear,” says
Prosser. “With 340 students I bet that if they all flipped coins to determine
their answers there would be at least one exam with two or fewer answers
correct.” Crowell says, “I’m with Prosser. In fact, I bet that we should expect
at least one exam in which no answer is correct if everyone is just guessing.”
Who is right in all of this?
<br /><br />
<i>Answer</i><br />
Finding the probabilities in R. For 2 or fewer points there should be several students
who get 2 or fewer points when there are 340 students. Even for 1 or fewer there should be a few.
A score of 0 is unlikely with 340 students. Prosser is correct.
<br /><br />
<b>Code</b>:<br />
<div class="rcode">
<pre class="hljs" style="display: block; overflow-x: auto; padding: 0.5em; background: rgb(255, 255, 255) none repeat scroll 0% 0%; color: rgb(0, 0, 0);"><span class="hljs-comment" style="color: green;"># 03.02 - Exercise 18 - Exam Coin Flip</span>

<span class="hljs-comment" style="color: green;"># Binomial Distribution</span>
b &lt;- <span class="hljs-keyword" style="color: rgb(0, 0, 255);">function</span>(n, p, k) {
    q = <span class="hljs-number">1</span> - p
    prob = choose(n, k)*p**k*q**(n-k)
    <span class="hljs-keyword" style="color: rgb(0, 0, 255);">return</span>(prob)
}

<span class="hljs-comment" style="color: green;"># Probability of 0, 1 or 2</span>
b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>) + b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>) + b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">2</span>)
b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>) + b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">1</span>)
b(<span class="hljs-number">10</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">0</span>)
</pre>
</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">
> # Probability of 0, 1 or 2
> b(10, 0.5, 0) + b(10, 0.5, 1) + b(10, 0.5, 2)
[1] 0.0546875
> b(10, 0.5, 0) + b(10, 0.5, 1)
[1] 0.01074219
> b(10, 0.5, 0)
[1] 0.0009765625
</pre>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 19</h3>
A gin hand consists of 10 cards from a deck of 52 cards. Find the probability
that a gin hand has
<br /><br />
<b>(a)</b> all 10 cards of the same suit.
<br /><br />
<b>(b)</b> exactly 4 cards in one suit and 3 in two other suits.
<br /><br />
<b>(c)</b> a 4, 3, 2, 1, distribution of suits.
<br /><br />
<i>Answer</i><br />
The total combination of dealt cards is binom(52, 10) = 15820024220. Quite a few more possibilities than Poker.
Now we just have to count the number of possibilities.
<br /><br />
<b>(a)</b><br />
There are 4 suits, and for each suit we can get 10 cards in binom(13, 10) = 286 ways, 1144 ways in total.<br />
The probability is 1144/15820024220 = 0.00000007231342.
<br /><br />
<b>(b)</b><br />
For each suit, we draw 4 cards, so binom(13, 4) = 715. Next, for 2 of the remaining suits, i.e. binom(3, 2) = 3,
we draw 3 cards: binom(13, 3) = 286 - which counts for BOTH suits. For all 4 suits, there are: 4·715·3·286·286 = 701809680 ways.
<br />
The probability becomes 701809680/15820024220 = 0.04436211.
<br /><br />
<b>(c)</b><br />
For the first suit, there are binom(13, 4) = 715 possible draws. The next suit has binom(3, 1) = 3
possibilities, and there are binom(13, 3) = 286 possible draws. The third suit has binom(2, 1) = 2 possibilites,
and there are binom(13, 2) = 78 possible draws. The last suit is determined automatically, and there
are binom(13, 1) = 13 possible draws. All together, from 4 possible starting suits there are a total of:
4·715·3·286·2·78·13 = 4976468640 possible outcomes.<br />
The probability becomes 4976468640/15820024220 = 0.3145677.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 20</h3>
A six-card hand is dealt from an ordinary deck of cards. Find the probability
that:
<br /><br />
<b>(a)</b> All six cards are hearts.
<br /><br />
<b>(b)</b> There are three aces, two kings, and one queen.
<br /><br />
<b>(c)</b> There are three cards of one suit and three of another suit.
<br /><br />
<i>Answer</i><br />
The total number of possible combination of dealt cards is binom(52, 6) = 20358520. Now we simply count the possible outcomes.
<br /><br />
<b>(a)</b><br />
How many ways can we draw 6 hears? binom(13, 6) = 1716.<br />
The probability is 1716/20358520 = 0.00008428903.
<br /><br />
<b>(b)</b><br />
We can select 3 out of 4 aces in binom(4, 3) = 4 ways. The kings in binom(4, 2) = 6 ways, and the single queen in 4 ways.
A total of 4·6·4 = 96 ways.<br />
The probability is 96/20358520 = 0.00000471547.
<br /><br />
<b>(c)</b><br />
For each suit, we can select binom(13, 3) = 286. For the other suit, there are binom(3, 1) = 3 ways we can get it. And from that
suit there are a total of binom(13, 3) = 286 possible hands. In total: 4·286·3·286 = 981552 possibilites.<br />
The probability is 981552/20358520 = 0.04821333.
<br /><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 21</h3>
A lady wishes to color her fingernails on one hand using at most two of the
colors red, yellow, and blue. How many ways can she do this?
<br /><br />
<i>Answer</i><br />
This is simply how many ways we can choose 2 from 3: binom(3, 2) = 3 ways. The fingers are irrelevant as the problem is stated.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 22</h3>
How many ways can six indistinguishable letters be put in three mail boxes?
<i>Hint</i>: One representation of this is given by a sequence |LL|L|LLL| where the
|’s represent the partitions for the boxes and the L’s the letters. Any possible
way can be so described. Note that we need two bars at the ends and the
remaining two bars and the six L’s can be put in any order.
<br /><br />
<i>Answer</i><br />
Ignoring the borders and focusing on the inner portion, where we can place six Ls and two |s.
If we only have two Ls and one |, there are three possible ways.
<pre style="font-family: monospace; background: #eee;">
LL|
L|L
|LL
</pre>
If we represent this as the set {a, b, c}, then if we select two values there are binom(3, 2) = 3 ways. {a, b}, {a, c} and
{b, c}. This represents the case above - any missing values are replaced by a |.
<br /><br />
With this reasoning, we can represent the |s as missing values and draw 6 from 8. So there are binom(8, 6) = 28 possible ways
of putting the six letters into three boxes.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 23</h3>
Using the method for the hint in Exercise 22, show that r indistinguishable
objects can be put in n boxes in
$$
\binom{n + r - 1}{n - 1} = \binom{n + r - 1}{r}
$$
different ways.
<br /><br />
<i>Answer</i><br />
This is just a repetition of the reasoning with the set {a, b, c} in the previous exercise.
Will not give a more formal argument than that.
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 24</h3>
A travel bureau estimates that when 20 tourists go to a resort with ten hotels
they distribute themselves as if the bureau were putting 20 indistinguishable
objects into ten distinguishable boxes. Assuming this model is correct, find
the probability that no hotel is left vacant when the first group of 20 tourists
arrives.
<br /><br />
<i>Answer</i><br />
Using the method from the previous exercises, we find the total number of ways that
the customers can distribute themselves, which is:<br />
binom(20 + 10 - 1, 10) = binom(29, 10) = 20030010.
<br /><br />
Two possible outcomes are displayed bellow.
<pre style="font-family: monospace; background: #eee;">
§CCC|CC|CCC|CC|C|CC|C|CCC|C|CC§

§CCC|CCC||CC|CCC|CCC||CCC|C|CC§
</pre>
In the first case, all hotels have some customers. In the second case, there are two vacant hotels
which happens when two of the separators appear next to each other. The complement of the set we need
is to count all outcomes where at least two of the separators are next to each other.
<div class="note">No idea how to solve this!</div>
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />





<!-- p 124 -->
<h3>Exercise 25</h3>
An elevator takes on six passengers and stops at ten floors. We can assign
two different equiprobable measures for the ways that the passengers are discharged:
(a) we consider the passengers to be distinguishable or (b) we consider
them to be indistinguishable (see Exercise 23 for this case). For each
case, calculate the probability that all the passengers get off at different floors.
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 26</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 27</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 28</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 29</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 30</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 31</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 32</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 33</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 34</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 35</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 36</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 37</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 38</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 39</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />






<h3>Exercise 40</h3>
asd
<br /><br />
<i>Answer</i><br />
<br /><br />
<div class="exend">&#9632;</div>
<br /><br />



<!--

<b>Code</b>:<br />
<div class="rcode">

</div>
<br />
<b>Output</b>:<br />
<pre class="rcode">

</pre>
<br /><br />
-->

<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
<br /><br />
</div><!-- End page div-->
</body>
</html>

